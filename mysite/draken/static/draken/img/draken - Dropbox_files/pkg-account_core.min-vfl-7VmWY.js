(function(){define("modules/clean/account/email_verify_reasons",[],function(){return{SHARE_FOLDER:"share_folder",CREATE_API_APP:"create_api_app",PUBLIC_FOLDER:"public_folder",GENERIC:"generic",SHMODAL:"shmodal",SHARE_FILEVIEWER:"share_fileviewer",MOBILE_SHARE_FOLDER:"mobile_share_folder",EMAIL_ALIAS:"email_alias",CHANGE_EMAIL:"change_email",PROMPT_CAMPAIGN:"prompt_campaign",ADD_COMMENT:"add_comment",SUBSCRIBE_TO_COMMENTS:"subscribe_to_comments",CREATE_FILE_COLLECTOR:"create_file_collector",JOIN_DISCOVERED_TEAM:"join_discovery",CREATE_TEAM:"create_team",NEW_DFB_TEAM_TRY:"new_dfb_team_try",NEW_DFB_TEAM_BUY:"new_dfb_team_buy",GIFT_BUY:"gift_buy",REFER_FRIENDS:"refer_friends",UJ_VERIFY_EMAIL:"uj_verify_email"}})}).call(this),define("modules/clean/account_page/components/account_table",["require","exports","tslib","external/react","external/classnames"],function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BodyCell=function(e){var t=e.className,a=n.__rest(e,["className"]),i=o("account-maestro-table__body-cell",t);return r.createElement("td",n.__assign({className:i},a))},t.HeaderCell=function(e){var t=e.className,a=n.__rest(e,["className"]),i=o("account-maestro-table__header-cell",t);return r.createElement("th",n.__assign({className:i},a))},t.BodyRow=function(e){var t=e.className,a=n.__rest(e,["className"]),i=o("account-maestro-table__body-row",t);return r.createElement("tr",n.__assign({className:i},a))},t.HeaderRow=function(e){var t=e.className,a=n.__rest(e,["className"]),i=o("account-maestro-table__header-row",t);return r.createElement("tr",n.__assign({className:i},a))},t.TableHead=function(e){return r.createElement("thead",n.__assign({},e))},t.TableBody=function(e){return r.createElement("tbody",n.__assign({},e))},t.TableFooter=function(e){return r.createElement("tfoot",n.__assign({},e))},t.Table=function(e){var t=e.className,a=n.__rest(e,["className"]),i=o("account-maestro-table",t);return r.createElement("div",{className:"account-maestro-table-container"},r.createElement("table",n.__assign({className:i},a)))}}),define("modules/clean/account_page/components/action_table",["require","exports","tslib","external/react","external/classnames","external/spectrum/icon_form","external/spectrum/tertiary_link","modules/clean/account_page/components/account_table"],function(e,t,n,r,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClose=function(e){return function(){t.props.onClosePressed(e)}},t}return n.__extends(t,e),t.prototype.renderBodyRows=function(){var e=this;return(this.props.sortFunction?this.props.data.sort(this.props.sortFunction):this.props.data).map(function(t,n){var o=null!=e.props.hideClose&&e.props.hideClose(t);return r.createElement(s.BodyRow,{key:n},e.props.keys.map(function(o,a){return r.createElement(s.BodyCell,{key:n+"-"+a},e.props.renderRowDetail(t,o))}),r.createElement(s.BodyCell,{className:"action-table__close",key:n+"--1"},!o&&r.createElement(i.TertiaryLink,{"aria-label":e.props.dismissLabel(t),onClick:e.onClose(t),className:"action-table__button"},r.createElement(a.IconForm,{name:"cancel"}))))})},t.prototype.renderHeaderCells=function(){var e=this;return this.props.keys.map(function(t,n){return r.createElement(s.HeaderCell,{key:n},e.props.headers[t])})},t.prototype.render=function(){var e=o("action-table",this.props.tableClass);return r.createElement(s.Table,{className:e},r.createElement(s.TableHead,null,r.createElement(s.HeaderRow,null,this.renderHeaderCells(),r.createElement(s.HeaderCell,null))),r.createElement(s.TableBody,null,this.renderBodyRows()))},t})(r.Component);t.ActionTable=c}),define("modules/clean/account_page/components/button_block",["require","exports","tslib","external/react","external/spectrum/button","external/spectrum/tertiary_link","modules/clean/react/css"],function(e,t,n,r,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e="link"===this.props.buttonAction.kind?this.props.buttonAction.href:void 0,t={className:"account-button-block__button",onClick:"function"===this.props.buttonAction.kind?this.props.buttonAction.handler:void 0,disabled:this.props.disabled},i="secondary"===this.props.kind?r.createElement(o.Button,n.__assign({href:e},t,{variant:"secondary"}),this.props.buttonText):r.createElement("a",{href:e},r.createElement(a.TertiaryLink,n.__assign({},t),this.props.buttonText));return this.props.hideClickOption?r.createElement("div",{className:"account-page-module account-button-block"},r.createElement("div",{className:"account-button-block__label"},r.createElement("span",{className:"account-page-block__heading"},this.props.label),this.props.subtext&&r.createElement("div",{className:"account-page-block__subtext"},this.props.subtext,this.props.italicizedSubtext&&r.createElement("br",null),this.props.italicizedSubtext&&r.createElement("i",null,this.props.italicizedSubtext))),r.createElement("span",{className:"account-page-block__heading"},this.props.hideClickText)):r.createElement("div",{className:"account-page-module account-button-block"},r.createElement("div",{className:"account-button-block__label"},r.createElement("span",{className:"account-page-block__heading"},this.props.label),this.props.subtext&&r.createElement("div",{className:"account-page-block__subtext"},this.props.subtext,this.props.italicizedSubtext&&r.createElement("br",null),this.props.italicizedSubtext&&r.createElement("i",null,this.props.italicizedSubtext))),i)},t})(r.Component);t.ButtonBlock=i(s,["/static/css/account/pagelet/index-vflYXYWDc.css","/static/css/spectrum/index-vflsJ4Dxr.css"])}),define("modules/clean/account_page/components/info_tooltip",["require","exports","external/react","external/classnames","modules/core/i18n","modules/clean/react/tooltip","modules/clean/react/sprite"],function(e,t,n,r,o,a,i){"use strict";function s(e){var t=r("info-tooltip",e.className),s=e.position||a.TooltipPosition.RIGHT;return n.createElement("span",{className:t},e.prompt&&n.createElement("span",{className:"info-tooltip__prompt"},e.prompt),n.createElement(a.Tooltip,{position:s,tooltip_contents:e.content},n.createElement(i,{className:"info-tooltip__icon",group:"web",name:"info",alt:o._("More information")})))}Object.defineProperty(t,"__esModule",{value:!0}),t.InfoTooltip=s}),define("modules/clean/account_page/components/key_value_block",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css","external/spectrum/tertiary_link"],function(e,t,n,r,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=o("account-page-module ","account-key-value-block",this.props.className);return r.createElement("div",{className:e},r.createElement("span",{className:"account-key-value-block__key"},this.props.keyText),r.createElement("span",{className:"account-key-value-block__value"},this.props.valueText),r.createElement("div",{className:"account-key-value-block__links"},r.createElement(i.TertiaryLink,{className:"account-key-value-block__link",onClick:this.props.onLinkClick},this.props.linkText),this.props.secondLink&&r.createElement(i.TertiaryLink,{className:"account-key-value-block__link",onClick:this.props.onSecondLinkClick},this.props.secondValueText)))},t})(r.Component);t.KeyValueBlock=a(s,["/static/css/account/pagelet/index-vflYXYWDc.css"])}),define("modules/clean/account_page/components/loading",["require","exports","external/react","modules/core/i18n","modules/clean/static_urls"],function(e,t,n,r,o){"use strict";function a(){return n.createElement("div",{className:"account-loading-indicator"},n.createElement("img",{src:o.static_url("/static/images/icons/ajax-loading-small-blue-vflVk_QNP.gif"),alt:r._("Loading")}))}Object.defineProperty(t,"__esModule",{value:!0}),t.Loading=a}),define("modules/clean/account_page/components/mcl_toggle",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css","modules/core/i18n","modules/clean/keycode"],function(e,t,n,r,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){t.props.onToggle(!t.props.isOn)},t.onKeyPress=function(e){var n=e.charCode;n!==s.KeyCode.ENTER&&n!==s.KeyCode.SPACE||t.onClick()},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.isOn,t=e?i._("On"):i._("Off"),n=e?"on":"off",a=o("toggle",this.props.className);return r.createElement("div",{className:a,role:"button","aria-pressed":e,tabIndex:0,onKeyPress:this.onKeyPress,onClick:this.onClick},r.createElement("div",{className:"toggle__status toggle__status--"+n},t),r.createElement("div",{className:"toggle__toggle-container toggle__toggle-container--"+n},r.createElement("div",{className:"toggle__toggle toggle__toggle--"+n})))},t})(r.Component);t.Toggle=a(c,["/static/css/account/pagelet/index-vflYXYWDc.css"])}),define("modules/clean/account_page/components/toggle_block",["require","exports","tslib","external/react","external/classnames","modules/clean/account_page/components/info_tooltip","modules/clean/account_page/components/mcl_toggle","modules/clean/react/css","modules/clean/react/tooltip"],function(e,t,n,r,o,a,i,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e,t=o("account-page-module","account-toggle-block",this.props.className);return e=this.props.subLabel?r.createElement("div",{className:"account-toggle-block__label"},r.createElement("span",{className:"account-toggle-block__heading"},this.props.label),r.createElement("span",{className:"account-toggle-block__subtext"},this.props.subLabel)):this.props.tooltipText?r.createElement("div",{className:"account-toggle-block__tooltip-label"},r.createElement("div",null,this.props.label),this.props.tooltipText&&r.createElement(a.InfoTooltip,{content:this.props.tooltipText,position:c.TooltipPosition.BOTTOM})):r.createElement("div",{className:"account-toggle-block__label"},this.props.label),r.createElement("div",{className:t},e,this.props.detail&&r.createElement("div",{className:"account-toggle-block__detail"},this.props.detail),r.createElement(i.Toggle,{className:this.props.toggleClass,isOn:this.props.isOn,onToggle:this.props.onToggle}))},t})(r.Component);t.ToggleBlock=s(l,["/static/css/account/pagelet/index-vflYXYWDc.css","/static/css/spectrum/index-vflsJ4Dxr.css"])}),define("modules/clean/account_page/util",["require","exports","modules/clean/viewer","modules/constants/account_page"],function(e,t,n,r){"use strict";function o(){return n.get_viewer().get_user_by_id(window.ensemble.viewer.getActiveUser().userId)}function a(){return r.SHOW_PASS_POLICY_CONTROL}Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentUser=o,t.isPassPolicyEnabled=a}),define("modules/clean/account_page/widgets/billing/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/billing/api","modules/clean/account_page/util"],function(e,t,n,r,o){"use strict";function a(e){var t=this;return void 0===e&&(e=!1),function(a,i){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return"never_loaded"===i().billingInfo.loadingState||e?(a({type:"billing_info_load"}),[4,r.getBillingInfo(o.getCurrentUser().id)]):[3,2];case 1:return t=n.sent(),a({type:"billing_info_loaded",billingInfo:t}),[2,!0];case 2:return[2,!1]}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=a}),define("modules/clean/account_page/widgets/billing/api",["require","exports","tslib","modules/clean/ajax_as_promised"],function(e,t,n,r){"use strict";function o(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,r.WebRequest({url:"/account/ajax_billing_tab_model",subject_user:e,dataType:"json"})]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingInfo=o}),define("modules/clean/account_page/widgets/billing/payment_methods_util",["require","exports","external/react","modules/core/i18n"],function(e,t,n,r){"use strict";function o(e){return[t.GOOGLE_PLAY_SUBSCRIPTION,t.IOS_ONE_TIME_PAYMENT,t.IOS_SANDBOX_ONE_TIME_PAYMENT,t.IOS_RECURRING_PAYMENT,t.IOS_SANDBOX_RECURRING_PAYMENT].includes(e)}function a(e,t){return t||o(e)}function i(e){return e.isExternalBilling?n.createElement("a",{href:e.resellerLink,target:"_blank",rel:"noopener noreferrer"},r._("Go to %(reseller_name)s to view or make changes to your account details.").format({reseller_name:e.resellerName})):e.gatewayId===t.GOOGLE_PLAY_SUBSCRIPTION?r._("You purchased Dropbox %(dropbox_plan)s through Google Play.\n      To make changes to your subscription, visit the Google Play App Store.").format({dropbox_plan:e.dropboxPlan}):e.gatewayId===t.IOS_ONE_TIME_PAYMENT?r._("You purchased Dropbox %(dropbox_plan)s through the iOS app.\n        Your plan will expire on %(end_date)s.").format({dropbox_plan:e.dropboxPlan,end_date:e.endDate}):[t.IOS_RECURRING_PAYMENT,t.IOS_SANDBOX_RECURRING_PAYMENT].includes(e.gatewayId)?e.deactivated?r._("Your subscription from Apple is no longer active."):e.isOnTrial?n.createElement("div",null,n.createElement("span",null,r._("You started a Dropbox %(dropbox_plan)s trial through the iOS app.").format({dropbox_plan:e.dropboxPlan})),n.createElement("br",null),n.createElement("a",{href:"/help/9224",target:"_blank",rel:"noopener noreferrer"},r._("Learn how to cancel your Apple App Store subscription"))):n.createElement("div",null,n.createElement("span",null,r._("You purchased Dropbox %(dropbox_plan)s through the iOS app.").format({dropbox_plan:e.dropboxPlan})),n.createElement("br",null),n.createElement("a",{href:"/help/9224",target:"_blank",rel:"noopener noreferrer"},r._("Learn how to cancel your Apple App Store subscription"))):r._("Sorry, you cannot change your billing schedule at this time.")}function s(e,n,o,a,i,s){return n?r._("You’re being externally billed."):e===t.GOOGLE_PLAY_SUBSCRIPTION?r._("You purchased Dropbox %(dropbox_plan)s through Google Play.\n      To make changes to your subscription, visit the Google Play App Store.").format({dropbox_plan:o}):e===t.IOS_ONE_TIME_PAYMENT?r._("You purchased Dropbox %(dropbox_plan)s through the iOS app.\n        Your plan will expire on %(end_date)s.").format({dropbox_plan:o,end_date:a}):[t.IOS_RECURRING_PAYMENT,t.IOS_SANDBOX_RECURRING_PAYMENT].includes(e)?i?r._("Your subscription from Apple is no longer active."):s?r._("You started a Dropbox %(dropbox_plan)s trial through the iOS app.").format({dropbox_plan:o}):r._("You purchased Dropbox %(dropbox_plan)s through the iOS app.").format({dropbox_plan:o}):r._("Sorry, you cannot change your billing schedule at this time.")}Object.defineProperty(t,"__esModule",{value:!0}),t.NOT_APPLICABLE=-1,t.AUTHORIZE=0,t.PAYPAL=1,t.MANUAL=2,t.APPLE=3,t.BRAINTREE=4,t.GOOGLE_PLAY_SUBSCRIPTION=5,t.DROPBOX_DOLLARS=6,t.PAYPAL_REFERENCE_TRANSACTION=7,t.IOS_ONE_TIME_PAYMENT=8,t.RESELLER_LICENSE_KEY=9,t.SALES_USEROPS_MANUAL_CHARGE=10,t.NO_CHARGE_GATEWAY=11,t.ADYEN_SEPA_GATEWAY=12,t.EXTERNAL_BILLING=13,t.ADYEN_IDEAL_GATEWAY=14,t.IOS_RECURRING_PAYMENT=15,t.NO_PAYMENT_GATEWAY=16,t.BRAINTREE_AIB=17,t.MOCK_CHARGE_GATEWAY=1e4,t.MOCK_CC_GATEWAY=10001,t.MOCK_PENDING_GATEWAY=10002,t.IOS_SANDBOX_ONE_TIME_PAYMENT=1002,t.IOS_SANDBOX_RECURRING_PAYMENT=1003,t.shouldHidePaymentMethod=o,t.shouldHideBillingChange=a,t.getBillingDisabledMessage=i,t.getPaymentMethodDisabledMessage=s}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/payments/billing_info_base",["jquery","modules/clean/payments/cash","modules/clean/payments/pro_util","modules/clean/payments/payment_form_events","modules/core/controller_helpers"],function(t,n,r,o,a){var i,s,c,l,u;return s=n.Cash,c=n.CashUtil,u=r.TransitionInfoFetcher,l=r.TaxHelper,i=(function(){function n(t,n,r,o){this.$container=t,this.country_to_currency_map=n,this.transition_view_models=r,this.countryToTaxNameMap=o,this._recompute_costs_from_tvm=e(this._recompute_costs_from_tvm,this),this._recompute_costs=e(this._recompute_costs,this),this._display_tax=e(this._display_tax,this),this.updateForm=e(this.updateForm,this),this.getCurrentTransitionViewModel=e(this.getCurrentTransitionViewModel,this),this._getCurrency=e(this._getCurrency,this),this.listen_tax=e(this.listen_tax,this),this.transition_info_fetcher=new u(this.transition_view_models),this.payment_form=a.get_controller(this.$container.find(".payment-form-component")),this.hasTax=null!=this.countryToTaxNameMap,this.transition_view_models&&(this.transition_view_model=this.transition_view_models[0]),this.listen_tax()}return n.prototype.listen_tax=function(){if(this.hasTax)return this.$container.on(o.LOCATION_CHANGE_EVENT,(function(e){return function(t,n){if(t.stopPropagation(),l.require_recompute(e.get_country_code(),e.get_zip_code()))return e.updateForm()}})(this))},n.prototype.get_zip_code=function(){return this.$container.find('input:visible[name="zip"]').val()},n.prototype.get_country_code=function(){return this.$container.find('[name="country_code"]').val()},n.prototype._getCountryTaxName=function(e){return this.countryToTaxNameMap[e]||this.countryToTaxNameMap.Other},n.prototype._getCurrency=function(){var e,t;return e=this.payment_form.get_country_code(),null!=(t=this.country_to_currency_map)?t[e]:void 0},n.prototype.getCurrentTransitionViewModel=function(){return this.transition_view_model},n.prototype.updateForm=function(){return this._recompute_costs()},n.prototype._display_tax=function(){return l.display_tax(this.get_country_code())?(t(".tax-row").removeClass("hidden_elem"),t(".tax-name-wrapper").text(this._getCountryTaxName(this.get_country_code())),!0):(t(".tax-row").addClass("hidden_elem"),!1)},n.prototype._recompute_costs=function(){var e;return e={zip:this.get_zip_code(),country_code:this.get_country_code()},this.transition_info_fetcher.get(this._recompute_costs_from_tvm,e,!0)},n.prototype._recompute_costs_from_tvm=function(e){var n,r,o,a,i,u,_,p,m,d,h,f,g;if(e)return this.transition_view_model=e,r=this._getCurrency(),this.$container.find(".currency-wrapper").text(r),h=l.compute_tax(e.read_only_invoice,r),p=h[0],n=h[1],f=h[2],o=c.formatCurrency(p.amount,p.currency),this.$container.find(".price-amount-wrapper").text(o),e.rebill&&(m=s.fromObject(e.rebill.total),a=c.formatCurrency(m.amount,m.currency),this.$container.find(".rebill-amount-wrapper").text(a)),e.state.total_recurring_price&&(d=s.fromObject(e.state.total_recurring_price),i=c.formatCurrency(d.amount,d.currency),this.$container.find(".rebill-price-wrapper").text(i)),g=this._getTotalAmount(e),_=c.formatCurrency(g.amount,g.currency),this.$container.find(".total-amount-wrapper").text(_),t(".tax-row").toggleClass("hidden_elem",this._display_tax()),u=c.formatCurrency(f.amount,f.currency),t(".tax-amount-wrapper").text(u),[p,n,f,m,r]},n})(),{BillingInfoModalBase:i}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function r(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},n={}.hasOwnProperty,r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/payments/billing_info_modal",["jquery","modules/core/cookies","modules/core/uri","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/payments/payment_form_events","modules/clean/deprecated/uirequest","modules/clean/payments/cash","modules/clean/payments/pro_util","modules/clean/payments/billing_info_base"],function(o,a,i,s,c,l,u,_,p,m){var d,h,f,g;return g=s.TeamsWebActionsLogger,f=c.DBModalStack,h=_.Cash,_.CashUtil,p.TransitionInfoFetcher,p.TaxHelper,d=m.BillingInfoModalBase,(function(s){function c(t,n,a,s,_){this.$container=t,this.payment_link_map=n,this.transition_view_models=a,this.country_to_currency_map=s,this.countryToTaxNameMap=_,this._update_disclaimer=e(this._update_disclaimer,this),this._postRequest=e(this._postRequest,this),c.__super__.constructor.call(this,this.$container,this.country_to_currency_map,this.transition_view_models,this.countryToTaxNameMap),this.$container.on("click",".cancel-button",function(){return g.log("update_billing_open_cancel"),f.pop()}),this.$container.on("click",".confirm-button",(function(e){return function(){if(g.log("update_billing_open_save_changes_click"),e.payment_form.validate())return e.$container.find(".confirm-button").prop("disabled",!0),e.payment_form.get_form_inputs(function(t){var n,a,s,l;return e.$container.find(".confirm-button").prop("disabled",!1),l=["resubscribe"],e.$container.find("input, select").each(function(e,n){var a,i;if(a=o(n),i=a.attr("name"),r.call(l,i)>=0)return t[i]=a.val()}),s=e.payment_form.get_selected_payment_method_id(),a=e.payment_link_map[s],"extra_params"in a&&(n=a.extra_params,o.extend(t,n)),a.use_form_post?e._postRequest(i({path:a.endpoint}),t):new u(e.$container,a.endpoint,{data:t,success:function(e){if(e.data&&e.data.success)return g.log("update_billing_open_save_changes_success"),f.trigger(c.BILLING_INFO_UPDATED),f.pop()}})})}})(this)),this.payment_form.$container.on(l.PAYMENT_METHOD_TYPE_CHANGE_EVENT,this._update_disclaimer),null!=this.transition_view_models&&this.updateForm()}return t(c,s),c.BILLING_INFO_UPDATED="billing_info_modal:updated",c.prototype._postRequest=function(e,t){var r,o,i;t.t=a.read("__Host-js_csrf"),o=document.createElement("form"),o.action=e,o.method="POST",document.body.appendChild(o);for(i in t)n.call(t,i)&&(r=document.createElement("input"),r.type="hidden",r.name=i,r.value=t[i],o.appendChild(r));return o.submit()},c.prototype._update_disclaimer=function(e,t){return t=parseInt(t,10),this.$container.find(".payment-method-disclaimer").each(function(e,n){var r;return r=o(n).data("payment-method-id"),o(n).toggleClass("hidden",r!==t)})},c.prototype._getTotalAmount=function(e){return h.fromObject(e.read_only_invoice.total)},c})(d)})}.call(this),define("modules/clean/payments/cash",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}return e.set_locale_number_format=function(t,n,r){void 0===t&&(t=","),void 0===n&&(n="."),void 0===r&&(r="-"),e.groupSymbol=t,e.decimalSymbol=n,e.minusSignSymbol=r},e.set_currency_format_map=function(t){e.currencyFormatMap=t},e.update_currency_format_map=function(t,n){e.currencyFormatMap[t]=n},e.formatAmountThousandsHelper=function(t){var n=Math.abs(parseInt(t,10)).toFixed(0).toString();if(n.length<=3)return n;var r=n.substr(0,n.length-3);return e.formatAmountThousandsHelper(r)+e.groupSymbol+n.substr(n.length-3)},e.roundCurrency=function(t,n,r){return void 0===n&&(n="USD"),void 0===r&&(r=2),r=t%1===0?0:r,e.formatCurrency(t,n,r)},e.formatCurrency=function(t,n,r){void 0===n&&(n="USD"),void 0===r&&(r=2);var o=parseFloat(t);"JPY"===n&&(r=0);var a=e.formatNumber(o,r);return e.currencyFormatMap[n]?e.currencyFormatMap[n].replace("%v",a):a+" "+n},e.splitFormatCurrency=function(t,n,r){void 0===n&&(n="USD"),void 0===r&&(r=2);var o=e.formatCurrency(t,n,r),a=o.indexOf(e.decimalSymbol);return a===-1?[o,""]:[o.slice(0,a+1),o.slice(a+1)]},e.formatNumber=function(t,n){void 0===n&&(n=2);var r=t<0?e.minusSignSymbol:"",o="";return n>0&&(o=e.decimalSymbol+t.toFixed(n).split(".")[1]),r+e.formatAmountThousandsHelper(t)+o},e.removeFormatting=function(t,n){var r=e.currencyFormatMap[n],o=r.replace("%v","");return t.replace(o,"").replace(e.groupSymbol,"")},e})();r.groupSymbol=",",r.decimalSymbol=".",r.minusSignSymbol="-",r.currencyFormatMap={USD:"$%v"},t.CashUtil=r;var o=(function(){function e(e,t){this.cash1=e,this.cash2=t}return e})();t.CashCurrenciesDoNotMatch=o;var a=(function(){function e(){}return e})();t.CashNeedsAmountAndCurrency=a;var i=(function(){function e(e,t){this.currency=t;var n=parseFloat(""+e);if(isNaN(n)||!this.currency)throw new a;var r=Math.pow(10,2);this.amount=Math.round(n*r)/r}return e.fromObject=function(t){return new e(parseFloat(t.amount),t.currency)},e.fromString=function(t,n){return new e(r.removeFormatting(t,n),n)},e.prototype.add=function(t){if(this.currency!==t.currency)throw new o(this,t);return new e(this.amount+t.amount,this.currency)},e.prototype.subtract=function(t){return this.add(new e(-t.amount,t.currency))},e.prototype.multiply=function(t){return new e(this.amount*t,this.currency)},e.prototype.divide=function(t){return new e(this.amount/t,this.currency)},e.prototype.round=function(t){void 0===t&&(t=2);var n=Math.pow(10,t);return new e(Math.round(this.amount*n)/n,this.currency)},e.prototype.toString=function(e){return void 0===e&&(e=2),"JPY"===this.currency&&(e=0),r.roundCurrency(this.amount,this.currency,e)},e.prototype.formatCurrency=function(e){return void 0===e&&(e=2),r.formatCurrency(this.amount,this.currency,e)},e.formatWithTaxLabels=function(e,t){return e&&t?t.doesTaxApply?n._("%(price)s (taxes included)").format({price:e.formatCurrency()}):e.formatCurrency():""},e})();t.Cash=i}),function(){define("modules/clean/payments/payment_form_events",[],function(){return(function(){function e(){}return e.LOCATION_CHANGE_EVENT="db:paymentform:countrycodechanged",e.ZIP_CHANGE_EVENT="db:paymentform:zipchanged",e.PAYMENT_METHOD_TYPE_CHANGE_EVENT="db:paymentform:paymentmethodtypechanged",e.VAT_CHANGE_EVENT="db:paymentform:vatchanged",e.UNVALIDATED="db:paymentform:unvalidated",e.VALIDATE_ERROR="db:paymentform:validateerror",e.VALIDATE_SUCCESS="db:paymentform:validatesuccess",e.LOADED_EVENT="db:paymentform:loaded",e.IFRAME_LOADED_EVENT="db:paymentform:iframeloaded",e.IFRAME_FIELDS_STATUS_EVENT="db:paymentform:iframefieldsstatusevent",e.TRANSITION_FETCHED="db:paymentform:transitionfetched",e.EDIT_SIMPLE_COUNTRY_CLICK_EVENT="db:paymentform:editsimplecountry",e})()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/payments/pro_util",["external/underscore","modules/clean/ajax","modules/clean/payments/cash","modules/clean/payments/validation","modules/core/exception"],function(t,n,r,o,a){var i,s,c;return i=r.Cash,a.assert,s=(function(){function e(){}return e.compute_tax=function(e,t){var n,r,o,a,s,c,l,u,_;for(c=null,r=null,_=new i(0,t),u=e.line_items,o=0,a=u.length;o<a;o++)s=u[o],1===s.line_item_type?c=s:2===s.line_item_type&&(r=s),s.country_tax_amount&&(_=_.add(i.fromObject(s.country_tax_amount))),s.state_tax_amount&&(_=_.add(i.fromObject(s.state_tax_amount)));return l=null!=c?i.fromObject(c.line_item_price):new i(0,t),n=null!=r?i.fromObject(r.line_item_price):new i(0,t),[l,n,_]},e.require_recompute=function(e,t){return"US"===e&&/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(t)},e.display_tax=function(e){return"US"===e},e})(),c=(function(){function r(t){var n,r,o,a;if(this.default_transition_view_models=t,this._get_transition_info_for=e(this._get_transition_info_for,this),this._add_to_cache=e(this._add_to_cache,this),this._has_inflight_request=e(this._has_inflight_request,this),this.get=e(this.get,this),this._get_state_json=e(this._get_state_json,this),this._cache_key_from_transition=e(this._cache_key_from_transition,this),this._requests={},this.transition_info_cache={},this.default_transition_view_models)for(o=this.default_transition_view_models,n=0,r=o.length;n<r;n++)a=o[n],this._add_to_cache(a)}return r.prototype._cache_key=function(e){return t.values(e).join(":")},r.prototype._cache_key_from_transition=function(e){var t,n,r;return t={country_code:null!=(n=e.read_only_invoice)?n.tax_country_code:void 0,zip_code:null!=(r=e.read_only_invoice)?r.tax_zip_code:void 0},this._cache_key(t)},r.prototype._get_state_json=function(){var e,t,n;return n=null!=(e=this.default_transition_view_models)&&null!=(t=e[0])?t.state:void 0,JSON.stringify(n)},r.prototype.get=function(e,r,o){var a,i,s;if(a=this._cache_key(r),i=this._get_transition_info_for(a))return void e(i);if(!this._requests[a]){if(this._has_inflight_request()&&o)for(s in this._requests)delete this._requests[s];else if(this._has_inflight_request())return;return this._requests[a]=!0,n.SilentBackgroundRequest({url:"/pro/ajax_transition_view_model",dataType:"json",data:t.extend({json_state:this._get_state_json()},r),success:(function(t){return function(n){if(t._add_to_cache(n),null!=t._requests[a])return delete t._requests[a],e(n)}})(this),error:(function(e){return function(t){if(null!=e._requests[a])return delete e._requests[a]}})(this)})}},r.prototype._has_inflight_request=function(){return Object.keys(this._requests).length},r.prototype._add_to_cache=function(e){var t;return t=this._cache_key_from_transition(e),this.transition_info_cache[t]=e},r.prototype._get_transition_info_for=function(e){return null!=this.transition_info_cache[e]},r})(),{TransitionInfoFetcher:c,TaxHelper:s}})}.call(this),define("modules/clean/payments/validation",["require","exports"],function(e,t){"use strict";function n(e){return!!c[e]}function r(e,t){return!t.trim().length||(t=t.replace(/\s+/g,""),!!c[e]&&c[e].regex.test(t))}function o(e){return c[e]?c[e].prefix:""}function a(e){return c[e]?c[e].examples:[]}function i(e){return c[e]?c[e].maxLength:0}function s(e){if(e=e.replace(/\s+/g,""),e.length<2)return!1;switch(e.substring(0,2)){case"AT":return/^AT[0-9]{18}$/.test(e);case"BE":return/^BE[0-9]{14}$/.test(e);case"CY":return/^CY[0-9]{10}[0-9a-zA-Z]{16}$/.test(e);case"CZ":return/^CZ[0-9]{22}$/.test(e);case"DE":return/^DE[0-9]{20}$/.test(e);case"EE":return/^EE[0-9]{18}$/.test(e);case"ES":return/^ES[0-9]{22}$/.test(e);case"FI":return/^FI[0-9]{16}$/.test(e);case"FR":return/^FR[0-9]{12}[0-9a-zA-Z]{11}[0-9]{2}$/.test(e);case"GR":return/^GR[0-9]{9}[0-9a-zA-Z]{16}$/.test(e);case"HU":return/^HU[0-9]{26}$/.test(e);case"HR":return/^HR[0-9]{19}$/.test(e);case"IE":return/^IE[0-9]{2}[0-9a-zA-Z]{4}[0-9]{14}$/.test(e);case"IT":return/^IT[0-9]{2}[A-Z]{1}[0-9]{10}[0-9a-zA-Z]{12}$/.test(e);case"LU":return/^LU[0-9]{5}[0-9a-zA-Z]{13}$/.test(e);case"NL":return/^NL[0-9]{2}[A-Z]{4}[0-9]{10}$/.test(e);case"PL":return/^PL[0-9]{26}$/.test(e);case"PT":return/^PT[0-9]{23}$/.test(e);case"SE":return/^SE[0-9]{22}$/.test(e)}return!1}Object.defineProperty(t,"__esModule",{value:!0});var c={AT:{prefix:"AT",regex:/^ATU[0-9]{8}$/,examples:["ATU12345678"],maxLength:11},BE:{prefix:"BE",regex:/^BE(0?|1)[0-9]{9}$/,examples:["BE0123456789","BE1123456789","BE1234567890"],maxLength:12},BG:{prefix:"BG",regex:/^BG[0-9]{9,10}$/,examples:["BG123456789","BG1234567890"],maxLength:12},CH:{prefix:"CH",regex:/^CHE[0-9]{9}(TVA|MWST|IVA)$/,examples:["CHE123456789TVA","CHE123456789MWST","CHE123456789IVA"],maxLength:16},CY:{prefix:"CY",regex:/^CY[0-9]{8}[A-Z]$/,examples:["CY12345678X"],maxLength:11},CZ:{prefix:"CZ",regex:/^CZ[0-9]{8,10}$/,examples:["CZ12345678","CZ123456789","CZ1234567890"],maxLength:12},DE:{prefix:"DE",regex:/^DE[0-9]{9}$/,examples:["DE123456789"],maxLength:11},DK:{prefix:"DK",regex:/^DK[0-9]{8}$/,examples:["DK12345678"],maxLength:10},EE:{prefix:"EE",regex:/^EE[0-9]{9}$/,examples:["EE123456789"],maxLength:11},GR:{prefix:"EL",regex:/^EL[0-9]{9}$/,examples:["EL123456789"],maxLength:11},ES:{prefix:"ES",regex:/^ES([A-Z][0-9]{7}[0-9A-Z]|[0-9A-Z][0-9]{7}[A-Z])$/,examples:["ESX12345678","ES12345678X","ESX1234567X"],maxLength:11},FI:{prefix:"FI",regex:/^FI[0-9]{8}$/,examples:["FI12345678"],maxLength:10},FR:{prefix:"FR",regex:/^FR[0-9A-Z]{2}[0-9]{9}$/,examples:["FR12345678901","FRX1234567890","FR1X123456789","FRXX123456789"],maxLength:13},GB:{prefix:"GB",regex:/^GB([0-9]{9}|[0-9]{12}|GD[0-9]{3}|HA[0-9]{3})$/,examples:["GB123456789","GB123456789012","GBGD123","GBHA123"],maxLength:14},HR:{prefix:"HR",regex:/^HR[0-9]{11}$/,examples:["HR12345678901"],maxLength:13},HU:{prefix:"HU",
regex:/^HU[0-9]{8}$/,examples:["HU12345678"],maxLength:10},IE:{prefix:"IE",regex:/^IE([0-9][0-9A-Z+*][0-9]{5}[A-Z]{1,2}|[0-9]{7}WI)$/,examples:["IE1X23456X","IE1X23456X","IE1234567XX"],maxLength:11},IT:{prefix:"IT",regex:/^IT[0-9]{11}$/,examples:["IT12345678901"],maxLength:13},LT:{prefix:"LT",regex:/^LT([0-9]{9}|[0-9]{12})$/,examples:["LT123456789","LT123456789012"],maxLength:14},LU:{prefix:"LU",regex:/^LU[0-9]{8}$/,examples:["LU12345678"],maxLength:10},LV:{prefix:"LV",regex:/^LV[0-9]{11}$/,examples:["LV12345678901"],maxLength:13},MT:{prefix:"MT",regex:/^MT[0-9]{8}$/,examples:["MT12345678"],maxLength:10},NL:{prefix:"NL",regex:/^NL[0-9]{9}B[0-9]{2}$/,examples:["NL123456789B01"],maxLength:14},NO:{prefix:"NO",regex:/^NO[0-9]{9}(MVA)?$/,examples:["NO123456789","NO123456789MVA"],maxLength:14},PL:{prefix:"PL",regex:/^PL[0-9]{10}$/,examples:["PL1234567890"],maxLength:12},PT:{prefix:"PT",regex:/^PT[0-9]{9}$/,examples:["PT123456789"],maxLength:11},RO:{prefix:"RO",regex:/^RO[0-9]{2,10}$/,examples:["RO12","RO1234567890"],maxLength:12},SE:{prefix:"SE",regex:/^SE[0-9]{12}$/,examples:["SE123456789012"],maxLength:14},SI:{prefix:"SI",regex:/^SI[0-9]{8}$/,examples:["SI12345678"],maxLength:10},SK:{prefix:"SK",regex:/^SK[0-9]{10}$/,examples:["SK1234567890"],maxLength:12}};t.hasVat=n,t.validateVat=r,t.getVatPrefix=o,t.getVatExamples=a,t.getVatMaxLength=i,t.validIBANForCountry=s});
//# sourceMappingURL=pkg-account_core.min.js-vflEh4aCn.map