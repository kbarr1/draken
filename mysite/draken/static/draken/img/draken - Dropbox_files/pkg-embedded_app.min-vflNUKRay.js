define("modules/clean/appshell/pagelet_init_hooks",["require","exports","modules/core/notify","modules/clean/web_user_action_logger","modules/core/i18n"],function(e,t,r,n,s){"use strict";function a(){window.ensemble&&window.ensemble.switchedAccounts&&(r.success(s._("You have switched to your %(account_name)s account.").format({account_name:window.ensemble.viewer.getActiveUser().displayName.toLocaleLowerCase()})),n.WebUserActionLog.log(window.ensemble.viewer.getActiveUser().userId,n.WebUserActionLogEvents.SWITCH_ACCOUNT,{}))}Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=a}),define("modules/clean/browse_interface",["require","exports","tslib","modules/clean/history","modules/clean/viewer","modules/core/i18n","modules/core/uri"],function(e,t,r,n,s,a,i){"use strict";function o(e){return s.get_viewer().is_paired?"personal"===e.role?p+t.PERSONAL_ROOT:p+t.WORK_ROOT:p+t.HOME_ROOT}function _(e){return s.get_viewer().is_paired?s.get_root_name(e):a._("Files")}function c(){return s.get_viewer().get_users().map(function(e){return{name:_(e),path:o(e)}})}function l(e,t){return new i({scheme:"https",authority:"www.dropbox.com",path:""+o(e)+t})}function u(e,t){return"/"!==t.charAt(0)&&(t="/"+t),new i({scheme:"https",authority:"www.dropbox.com",path:p+"/preview"+t,query:{role:e.role}})}function h(e){p=e}function d(e,t){var n=e.fqPath,s=e.userId,a=r.__assign({},null==t?{}:t,(o={undelete:"1"},o._subject_uid=String(s),o));n=n.replace(/^[\/]/,"");return new i({path:"/history/"+n}).updateQuery(a).toString();var o}function E(e){var t=e.fqPath,r=e.userId,s=(a={prev:i.parse(n.get_url()).setFragment("").toString()},a._subject_uid=String(r),a);return t=t.replace(/^[\/]/,""),new i({path:"/restore/"+t}).updateQuery(s).toString();var a}Object.defineProperty(t,"__esModule",{value:!0}),t.HOME_ROOT="/home",t.WORK_ROOT="/work",t.PERSONAL_ROOT="/personal";var p="";t.get_browse_root=o,t.get_browse_root_name=_,t.get_all_browse_roots=c,t.browse_uri_for_fq_path=l,t.preview_uri_for_fq_path=u,t.set_base_prefix=h,t.getFileHistoryUrl=d,t.getRestoreFileUrl=E}),define("modules/clean/immutability_helper",["require","exports","external/deep-freeze"],function(e,t,r){"use strict";function n(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return p.call(e);for(var t=Object.create(Object.getPrototypeOf(e)),r=Object.getOwnPropertyNames(e),n=0,s=r;n<s.length;n++){var a=s[n],i=Object.getOwnPropertyDescriptor(e,a);i&&(i.get||i.set)?(i.configurable=!0,Object.defineProperty(t,a,i)):t[a]=e[a]}return t}function s(e,t){var s=n(e);return t(s),r(s)}function a(e,t){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));return t.reduce(function(e,t){return null==e?null:e[t]},e)}function i(e,t,s){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[t]===s)return e;var a=n(e);return a[t]=s,r(a)}function o(e,t,r){return i(e,t,r(e[t]))}function _(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];return 1===t.length?o(e,n,r):i(e,n,_(e[n],t.slice(1),r))}function c(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];switch(t.length){case 1:return i(e,n,r);default:return i(e,n,c(e[n]||{},t.slice(1),r))}}function l(e,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");var s=Object.keys(t).reduce(function(r,n){return t[n]!==e[n]&&r.push(n),r},[]);if(s.length){for(var a=n(e),i=0,o=s;i<o.length;i++){var _=o[i];Object.defineProperty(a,_,Object.getOwnPropertyDescriptor(t,_))}return r(a)}return e}function u(e,t,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");return _(e,t,function(e){return l(e,r)})}function h(e,t,n){for(var s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];var i=p.call(e);return i.splice.apply(i,[t,n].concat(s)),r(i)}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=p.call(e);return s.unshift.apply(s,t),r(s)}function E(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=p.call(e);return s.push.apply(s,t),r(s)}Object.defineProperty(t,"__esModule",{value:!0});var p=Array.prototype.slice;t.thaw=n,t.withMutations=s,t.getIn=a,t.set=i,t.update=o,t.updateIn=_,t.setIn=c,t.merge=l,t.mergeIn=u,t.splice=h,t.unshift=d,t.push=E}),function(){define("modules/clean/profiling",["external/react","modules/clean/web_timing_logger"],function(e,t){var r,n;return r=e.DOM,n=e.createClass({render:function(){return r.div({},"Hello!")},componentDidMount:function(){return t.mark_time_to_interactive()}}),{hello_component:n}})}.call(this),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NotReady=0]="NotReady",e[e.PendingInitialRequest=1]="PendingInitialRequest",e[e.NotLive=2]="NotLive",e[e.Live=3]="Live"})(t.BrowseBoltClientStatus||(t.BrowseBoltClientStatus={})),t.BrowseActionTypes={INITIALIZE_EVERYTHING:"INITIALIZE_EVERYTHING",LOAD_PATH:"LOAD_PATH",ADD_FILES:"ADD_FILES",ADD_FILES_AND_SET_LOADING_STATE:"ADD_FILES_AND_SET_LOADING_STATE",SET_PATH:"SET_PATH",SET_USER:"SET_USER",SET_URL_PREFIX:"SET_URL_PREFIX",SET_LOADING_STATE:"SET_LOADING_STATE",SET_MOUNT_POINTS:"SET_MOUNT_POINTS",SET_TEAM_FOLDERS:"SET_TEAM_FOLDERS",CHANGE_FILES:"CHANGE_FILES",SET_SELECTION:"SET_SELECTION",SELECT_FILES_AFTER_UPLOAD:"SELECT_FILES_AFTER_UPLOAD",SELECT_FILES_BY_FQ_PATH:"SELECT_FILES_BY_FQ_PATH",SET_SHOULD_SHOW_DELETED_FILES:"SET_SHOULD_SHOW_DELETED_FILES",SET_DROP_TARGET:"SET_DROP_TARGET",SORT_FILES:"SORT_FILES",SET_VIEW_TYPE:"SET_VIEW_TYPE",SET_COPY_MODE:"SET_COPY_MODE",COPY_FILES_TO_CLIPBOARD:"COPY_FILES_TO_CLIPBOARD",REQUEST_NEW_FILE_NAME:"REQUEST_NEW_FILE_NAME",CANCEL_FILE_RENAME:"CANCEL_FILE_RENAME",SET_FILE_RENAME_PENDING:"SET_FILE_RENAME_PENDING",SET_FILE_RENAME_COMPLETE:"SET_FILE_RENAME_COMPLETE",REQUEST_FOLDER_NAME:"REQUEST_FOLDER_NAME",CREATE_FOLDER_PENDING:"CREATE_FOLDER_PENDING",CREATE_FOLDER_COMPLETE:"CREATE_FOLDER_COMPLETE",CANCEL_CREATE_FOLDER:"CANCEL_CREATE_FOLDER",SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:"SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",TEAM_FOLDER_DOWNGRADE:"TEAM_FOLDER_DOWNGRADE",ADD_COMMENT_STATUS_BATCH:"ADD_COMMENT_STATUS_BATCH",ADD_FILE_JUMP_KEY_CODE:"ADD_FILE_JUMP_KEY_CODE",RESET_FILE_JUMP:"RESET_FILE_JUMP",SET_ACTIVE_TAB:"SET_ACTIVE_TAB",REQUEST_FETCH_FOLDER_SIZES:"REQUEST_FETCH_FOLDER_SIZES",FETCHED_FOLDER_SIZES:"FETCHED_FOLDER_SIZES",COMPLETE_FETCH_FOLDER_SIZES:"COMPLETE_FETCH_FOLDER_SIZES"},t.NewFolderCreationStates={CREATE_FOLDER_INACTIVE:"CREATE_FOLDER_INACTIVE",PENDING_INPUT:"PENDING_INPUT",SAVING_INPUT:"SAVING_INPUT"},t.LoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_REMAINING_PAGES:"LOADING_REMAINING_PAGES"},t.Direction={UP:"UP",DOWN:"DOWN"};(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(t.FileTypes||(t.FileTypes={})),t.REACT_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container",t.BrowseSortFields={FILENAME:"FILENAME",MODIFIED:"MODIFIED",CATEGORY:"CATEGORY",EXTENSION:"EXTENSION",SIZE:"SIZE",SHARED_WITH:"SHARED_WITH"},t.SortDirections={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},t.DropTargetHighlightMode={NONE:"NONE",ALL_FOLDERS:"ALL_FOLDERS",NONSELECTED_FOLDERS:"NONSELECTED_FOLDERS",NONSELECTED_NONSHARED_FOLDERS:"NONSELECTED_NONSHARED_FOLDERS",NONSELECTED_NONSHARED_NONTEAM_FOLDERS:"NONSELECTED_NONSHARED_NONTEAM_FOLDERS"};var n={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","indd","keynote","numbers","otf","pages","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk"],LINK:["url","webloc"],FONT:["ttf"]};t.BrowseTileGridConstants={NUM_THRESHOLD_ROWS:10,SCROLL_DELTA_THRESHOLD:1},t.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5},t.ItemTypes={CREATE_FOLDER_UI:"CreateFolderUI",LOADING_INDICATOR:"LoadingIndicator"},t.FileTypeCategoryTranslations={FILE:r._("File"),FOLDER:r._("Folder"),SHARED_FOLDER:r._("Shared folder"),TEAM_SHARED_FOLDER:r._("Team folder"),TEAM_MEMBER_FOLDER:r._("Member folder"),PUBLIC_FOLDER:r._("Folder"),IMAGE:r._("Image"),VIDEO:r._("Video"),AUDIO:r._("Audio"),DOCUMENT:r._("Document"),COMPRESSED_FILE:r._("Archive"),CODE:r._("Code"),DISK_IMAGE:r._("Disk image"),EXECUTABLE:r._("Executable"),SHORTCUT:r._("Shortcut"),LINK:r._("Link"),FONT:r._("Font"),SANDBOX:r._("App folder")},t.FileTypeCapitalizedCategoryTranslations={FILE:r._("FILE"),FOLDER:r._("FOLDER"),SHARED_FOLDER:r._("SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("MEMBER FOLDER"),PUBLIC_FOLDER:r._("FOLDER"),IMAGE:r._("IMAGE"),VIDEO:r._("VIDEO"),AUDIO:r._("AUDIO"),DOCUMENT:r._("DOCUMENT"),COMPRESSED_FILE:r._("ARCHIVE"),CODE:r._("CODE"),DISK_IMAGE:r._("DISK IMAGE"),EXECUTABLE:r._("EXECUTABLE"),SHORTCUT:r._("SHORTCUT"),LINK:r._("LINK"),FONT:r._("FONT"),SANDBOX:r._("APP FOLDER")},t.DeletedFileTypeCategoryTranslations={FILE:r._("Deleted file"),FOLDER:r._("Deleted folder"),SHARED_FOLDER:r._("Deleted shared folder"),TEAM_SHARED_FOLDER:r._("Deleted team folder"),TEAM_MEMBER_FOLDER:r._("Deleted member folder"),PUBLIC_FOLDER:r._("Deleted folder"),IMAGE:r._("Deleted image"),VIDEO:r._("Deleted video"),AUDIO:r._("Deleted audio"),DOCUMENT:r._("Deleted document"),COMPRESSED_FILE:r._("Deleted archive"),CODE:r._("Deleted code"),DISK_IMAGE:r._("Deleted disk image"),EXECUTABLE:r._("Deleted executable"),SHORTCUT:r._("Deleted shortcut"),LINK:r._("Deleted link"),FONT:r._("Deleted font"),SANDBOX:r._("Deleted app folder")},t.DeletedFileTypeCapitalizedCategoryTranslations={FILE:r._("DELETED FILE"),FOLDER:r._("DELETED FOLDER"),SHARED_FOLDER:r._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:r._("DELETED FOLDER"),IMAGE:r._("DELETED IMAGE"),VIDEO:r._("DELETED VIDEO"),AUDIO:r._("DELETED AUDIO"),DOCUMENT:r._("DELETED DOCUMENT"),COMPRESSED_FILE:r._("DELETED ARCHIVE"),CODE:r._("DELETED CODE"),DISK_IMAGE:r._("DELETED DISK IMAGE"),EXECUTABLE:r._("DELETED EXECUTABLE"),SHORTCUT:r._("DELETED SHORTCUT"),LINK:r._("DELETED LINK"),FONT:r._("DELETED FONT"),SANDBOX:r._("DELETED APP FOLDER")},t.ExtensionCategories={};for(var s=0,a=Object.keys(n);s<a.length;s++)for(var i=a[s],o=n[i],_=0,c=o;_<c.length;_++){var l=c[_];t.ExtensionCategories[l]=i}t.RenameStates={PENDING_INPUT:"pending-input",SAVING_INPUT:"saving-input"};(function(e){e[e.NONE=-1]="NONE",e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"})(t.MouseEventButton||(t.MouseEventButton={}));(function(e){e[e.ShareExisting=1]="ShareExisting",e[e.EditShared=2]="EditShared",e[e.EditSharedSubFolder=3]="EditSharedSubFolder"})(t.ShareFolderModalTypes||(t.ShareFolderModalTypes={})),t.SharedWithActionTypes={SET_SHARED_FOLDER_DATA:"SET_SHARED_FOLDER_DATA",SET_MEMBER_COUNTS_FOR_NS:"SET_MEMBER_COUNTS_FOR_NS",SET_SHARED_LINK_DATA:"SET_SHARED_LINK_DATA",SET_SHARED_FILE_DATA:"SET_SHARED_FILE_DATA",SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE:"SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE:"SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",CLEAR_SHARED_FOLDER_DATA_FOR_NS:"CLEAR_SHARED_FOLDER_DATA_FOR_NS",REMOVE_SHARED_LINK_DATA:"REMOVE_SHARED_LINK_DATA"},t.SEARCH_PREFIX="/search",t.ViewTypes={Grid:"GRID_VIEW",List:"LIST_VIEW"},t.FetchFolderSizeStates={LOADING:"LOADING",COMPLETE:"COMPLETE",NO_ACCESS:"NO_ACCESS",ERROR:"ERROR"},t.MAX_FOLDERS_PER_CALL=100,t.MAX_FOLDER_SIZE_QUEUE_SIZE=50,t.MAX_FOLDER_SIZE_ITERATIONS=1e3,t.CloudContentDocuments={GOOGLE_DOC:"gdoc",GOOGLE_SHEET:"gsheet",GOOGLE_SLIDE:"gslide",PAPER:"paper"},t.VIEW_TYPE_COOKIE_NAME="browse_view_type"}),define("modules/clean/react/browse/models",["require","exports","tslib","external/deep-freeze","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/react/browse/constants","modules/clean/sharing/constants","modules/constants/legacy","modules/clean/display_format"],function(e,t,r,n,s,a,i,o,_,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(e){this.ago=e.ago,this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.comment_count=e.comment_count,this.direct_blockserver_link=e.direct_blockserver_link,this.event_type=e.event_type,this.feedback_off=e.feedback_off,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.fq_path=e.fq_path,this.href=e.href,this.htmlified_link=e.htmlified_link,this.icon=e.icon,this.is_camera_uploads=e.is_camera_uploads,this.is_confidential_folder=e.is_confidential_folder,this.is_cloud_content=e.is_cloud_content,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_public_folder=e.is_public_folder,this.is_unmounted=e.is_unmounted,this.last_modified_fname=e.last_modified_fname,this.last_modified_name=e.last_modified_name,this.latest_rev=e.latest_rev,this.linkfile_data=e.linkfile_data,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.preview_type=e.preview_type,this.preview_url=e.preview_url,this.preview_thumbnail_url=e.preview_thumbnail_url,this.read_only=!!e.read_only,this.request_id=e.request_id,this.revision_id=e.revision_id,this.size=e.size,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.unresolved_comment_count=e.unresolved_comment_count,this.video_metadata_url=e.video_metadata_url,this.video_container=e.video_container,this.video_transcode_url=e.video_transcode_url,this.preview_ssr_text_url_tmpl=e.preview_ssr_text_url_tmpl,this.preview_ssr_image_url_tmpl=e.preview_ssr_image_url_tmpl,this.isDeleted=!!e.isDeleted,this.fetchFolderSizesStatus=e.fetchFolderSizesStatus}return e.fromServerObject=function(t){return new e(r.__assign({},t,{_mount_access_perms:t.mount_access_perms,isDeleted:t.bytes===-1}))},e.prototype.set=function(e,t){return s.set(this,e,t)},e.prototype.merge=function(e){return s.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getExtension=function(e){return e.is_dir?"":a.file_extension(a.filename(e.fq_path))},e.getCategoryDescription=function(t,r){void 0===r&&(r=!1);var n;if(t.is_dir)switch(n="FOLDER",t.type){case i.FileTypes.TEAM_SHARED_FOLDER:n="TEAM_SHARED_FOLDER";break;case i.FileTypes.SHARED_FOLDER:n="SHARED_FOLDER";break;case i.FileTypes.SANDBOX:n="SANDBOX";break;case i.FileTypes.TEAM_MEMBER_FOLDER:n="TEAM_MEMBER_FOLDER";break;default:t.target_ns&&(n="SHARED_FOLDER")}else n=i.ExtensionCategories[e.getExtension(t)]||"FILE";return t.isDeleted?r?i.DeletedFileTypeCapitalizedCategoryTranslations[n]:i.DeletedFileTypeCategoryTranslations[n]:r?i.FileTypeCapitalizedCategoryTranslations[n]:i.FileTypeCategoryTranslations[n]},e.isTeamSharedFolder=function(e){return e.type===i.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===i.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_edit")},e.isNoAccessSharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_view")},e.canViewFileMembers=function(e,t){var r=e._mount_access_perms;return!(r&&r.indexOf("can_view_members")<0)&&(!(t&&!t.canViewContainingNSMembers)||!!(r&&r.indexOf("can_view_members")>=0))},e.areEqual=function(e,t){return e.ns_id===t.ns_id&&e.sjid===t.sjid},e.revisionKey=function(e){return e.ns_id+":"+e.sjid},e.prototype.updateSize=function(e,t){return this.merge({bytes:e,size:c.format_bytes(e),fetchFolderSizesStatus:t})},e})();t.File=l;var u=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(t){return new e({isPublicFolderEnabled:t.public_folder_enabled,publicFolderFqPath:t.public_folder_fq_path,publicAppToken:t.public_app_token})},e.prototype.set=function(e,t){return s.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();t.Config=u;var h=(function(){function e(e){var t=void 0===e?{}:e,r=t.canViewContainingNSMembers,n=t.currentNSID,s=t.currentFQPath,a=t.currentMountPoint,i=t.currentNSPath,c=t.currentSharedFolderPermissionRole,l=t.currentNSAllowsNesting,h=t.inactiveNSIDByFQPath,d=t.permanentDeletionDisabledStateByNSID,E=t.isInFolderMode,p=t.isCurrentlyInRoot,S=t.isInsideSharedFolder,m=t.isInsideTeamFolderRoot,A=t.isInsideArchivedTeamFolder,f=t.isInsideTeamFolderTree,T=t.isInsideDeletedFolder,R=t.isInsideDeletedSharedFolder,O=t.isInsideDeletedNestedSharedFolder,I=t.isNonUserRelativeContext,g=t.pathRoot,D=t.rootNSID,N=t.showSharedFolderCreateTeamPromo,C=t.showPinnedTeamFolder,L=t.teamFolderOwnerTeamApiId,y=t.blockHash,v=t.config;this.canViewContainingNSMembers=null==r||r,this.currentNSID=n||_.root_ns_id,this.currentFQPath=s||"",this.currentMountPoint=a,this.currentNSPath=i,this.currentSharedFolderPermissionRole=null!=c?c:o.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!l,this.inactiveNSIDByFQPath=h||{},this.permanentDeletionDisabledStateByNSID=d||{},this.isInFolderMode=null==E||E,this.isCurrentlyInRoot=!!p,this.isInsideSharedFolder=!!S,this.isInsideTeamFolderRoot=!!m,this.isInsideArchivedTeamFolder=!!A,this.isInsideTeamFolderTree=!!f,this.isInsideDeletedFolder=!!T,this.isInsideDeletedSharedFolder=!!R,this.isInsideDeletedNestedSharedFolder=!!O,this.isNonUserRelativeContext=!!I,this.pathRoot=g,this.rootNSID=D,this.showSharedFolderCreateTeamPromo=!!N,this.showPinnedTeamFolder=!!C,this.teamFolderOwnerTeamApiId=L,this.blockHash=y,this.config=v||new u}return e.fromServerObject=function(t){var r=t.containing_fq_path||"";r.startsWith("/")||(r="/"+r);var n;t.inside_shared_folder&&(n=o.NameSpaceAccess.ACCESS_READER);var s,a=t.containing_ns_permissions||[],i=a.includes("mount_shared_folders");return t.inside_shared_folder&&(a.includes("edit_contents")&&(n=o.NameSpaceAccess.ACCESS_WRITER),a.includes("change_folder_options")&&(n=o.NameSpaceAccess.ACCESS_OWNER),a.includes("view_members")||(s=!1)),new e({blockHash:t.block_hash,canViewContainingNSMembers:s,config:u.fromServerObject(t),currentFQPath:r,currentMountPoint:t.containing_mount_point,currentNSAllowsNesting:i,currentNSID:t.containing_ns_id,currentNSPath:t.containing_ns_path,currentSharedFolderPermissionRole:n,inactiveNSIDByFQPath:t.old_path_to_ns_id,isCurrentlyInRoot:t.in_root_dir,isInFolderMode:t.inside_dir,isInsideArchivedTeamFolder:t.inside_archived_team_folder,isInsideTeamFolderRoot:t.inside_team_folder_root,isInsideDeletedFolder:t.inside_deleted_dir,isInsideDeletedNestedSharedFolder:t.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:t.inside_deleted_shared_folder,isInsideSharedFolder:t.inside_shared_folder,isInsideTeamFolderTree:t.inside_team_folder_tree,isNonUserRelativeContext:t.is_non_user_relative_context,pathRoot:t.path_root,permanentDeletionDisabledStateByNSID:t.permanent_delete_is_disabled_by_ns_id,rootNSID:t.root_ns_id,showPinnedTeamFolder:t.show_pinned_team_folder,showSharedFolderCreateTeamPromo:t.show_shared_folder_create_team_promo,teamFolderOwnerTeamApiId:t.team_folder_owner_team_dbtid})},e.prototype.set=function(e,t){return s.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,t=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||t===o.NameSpaceAccess.ACCESS_WRITER||t===o.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return a.filename(this.currentFQPath)},e})();t.BrowseContext=h;var d=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.creator_name=e.creator_name,this.last_modified_date=e.last_modified_date,this.request_id=e.request_id,this.sort_rank=e.sort_rank}return e.fromServerObject=function(t){return new e(t)},e})();t.Paper=d}),define("modules/clean/react/browse/paper_row_icon",["require","exports","tslib","external/react","modules/clean/react/sprite"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaperRowIcon=function(e){return n.createElement(s,r.__assign({group:"web",name:"paper_white_32",alt:""},e))}}),define("modules/clean/react/browse/render_partials",["require","exports","tslib","external/classnames","external/react","modules/clean/static_urls"],function(e,t,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasThumbFailed:!1},t.handleError=function(){var e=t.props.file.thumbnail_url_tmpl,r=t.state.hasThumbFailed;e&&!r&&t.setState({hasThumbFailed:!0})},t}return r.__extends(t,e),t.prototype.render=function(){var e,t,r=this.props,i=r.file,o=r.className,_=r.onClick,c=r.onDragStart,l=r.onMouseDown,u=i.thumbnail_url_tmpl,h=i.icon,d=this.state.hasThumbFailed;return u&&!d?(t=u,e=n(o)):(e=n("sprite","sprite_web","s_web_"+h,o),t=a.static_url("/static/images/icons/icon_spacer-vflN3BYt2.gif")),s.createElement("img",{className:e,src:t,onClick:_,onDragStart:c,onMouseDown:l,onError:this.handleError,alt:""})},t})(s.PureComponent);t.FileIcon=i}),define("modules/clean/react/maestro/a11y_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.TITLE=0]="TITLE",e[e.SEARCH_BAR=1]="SEARCH_BAR",e[e.NOTIFICATION_BELL=2]="NOTIFICATION_BELL",e[e.ACCOUNT_MENU=3]="ACCOUNT_MENU",e[e.MAIN_CONTENT=4]="MAIN_CONTENT",e[e.SIDE_BAR=5]="SIDE_BAR"})(t.LAYOUT_TAB_ORDER||(t.LAYOUT_TAB_ORDER={}))}),define("modules/clean/react/maestro/header",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/maestro/top_menu_container","modules/clean/react/image","modules/clean/static_urls","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive"],function(e,t,r,n,s,a,i,o,_,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement("header",{className:"maestro-header page-header__shadow"},n.createElement(c.VerticallyFixedWrapper,{className:"page-header",responsive:this.props.responsive},n.createElement("div",{className:"page-header__title",tabIndex:_.LAYOUT_TAB_ORDER.TITLE},this.props.title),n.createElement(a.TopMenuContainer,{user:this.props.user,showSearchBar:this.props.showSearchBar,isSearchBarExpanded:this.props.isSearchBarExpanded,currentPath:this.props.currentPath,onSearch:this.props.onSearch,onSearchResultOpen:this.props.onSearchResultOpen})))},t})(n.Component);l.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1};var u=function(e){var t=e.children;return n.createElement("h1",{className:"page-header__heading"},t)};t.MaestroHeaderTitle=u;var h=function(){return n.createElement("a",{href:"/",className:"page-header__logo"},n.createElement(i,{src:o.static_url("/static/images/header_logo-vflzsBFzu.png"),srcHiRes:o.static_url("/static/images/header_logo@2x-vflt21Kis.png"),alt:"Dropbox"}))};t.MaestroHeaderLogo=h;var d=s(l,["/static/css/maestro_header-vfl-1yEEy.css"]);t.PageletMaestroHeader=d}),define("modules/clean/react/maestro/layout",["require","exports","tslib","external/react","external/spectrum/match","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive"],function(e,t,r,n,s,a,i,o,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(t){var r=e.call(this,t)||this;r.isPageResponsive=function(){return!(!document||!document.documentElement)&&document.documentElement.classList.contains(_.RESPONSIVE_CLASS)},r.handleMatchMedium=function(){r.setState({isMatchedMedium:!0})},r.handleUnmatchMedium=function(){r.setState({isMatchedMedium:!1})},r.handleMatchLarge=function(){r.setState({isMatchedLarge:!0})},r.handleUnmatchLarge=function(){r.setState({isMatchedLarge:!1})};var n=r.isPageResponsive();return r.state={isResponsive:n,isMatchedMedium:!n,isMatchedLarge:!n},r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.user,c=e.titleRegion,l=e.embeddedAppRegion,u=e.actionSidebarRegion,h=e.searchBarProps,d=r.__assign({},this.state),E=null;return null!=u&&(E=n.createElement("div",{className:"maestro-secondary-sidebar__shadow",tabIndex:o.LAYOUT_TAB_ORDER.SIDE_BAR},n.createElement(i.MaestroSecondarySidebar,{responsive:d},"function"==typeof u?u(d):u))),n.createElement("div",{className:"maestro-chrome"},d&&d.isResponsive&&n.createElement(s.Match,{media:_.BREAKPOINT_LARGE,onMatch:this.handleMatchLarge,onUnmatch:this.handleUnmatchLarge}),d&&d.isResponsive&&n.createElement(s.Match,{media:_.BREAKPOINT_MEDIUM,onMatch:this.handleMatchMedium,onUnmatch:this.handleUnmatchMedium}),n.createElement(a.PageletMaestroHeader,r.__assign({user:t,title:c,responsive:d},h||{})),n.createElement("main",{className:"maestro-app"},n.createElement("div",{className:"maestro-app-content",tabIndex:o.LAYOUT_TAB_ORDER.MAIN_CONTENT},"function"==typeof l?l(d):l),E))},t})(n.PureComponent);t.MaestroChrome=c}),define("modules/clean/react/maestro/profiling_blank_embedded_app",["require","exports","tslib","external/react","modules/clean/react/maestro/layout","modules/clean/profiling","modules/clean/react/maestro/header","modules/clean/viewer","modules/clean/web_timing_logger"],function(e,t,r,n,s,a,i,o,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=o.get_viewer(),t=e.get_user_by_id(this.props.uid);return n.createElement(s.MaestroChrome,{user:t,titleRegion:n.createElement(i.MaestroHeaderTitle,null,"Blank App"),embeddedAppRegion:n.createElement(a.hello_component,null)})},t.prototype.componentWillMount=function(){_.log_js_modules_application_code_start()},t})(n.Component);t.BlankEmbeddedApp=c}),define("modules/clean/react/maestro/responsive",["require","exports","tslib","external/react","external/spectrum/vertically_fixed"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESPONSIVE_CLASS="maestro--responsive",t.BREAKPOINT_MEDIUM="(min-width: 736px)",t.BREAKPOINT_LARGE="(min-width: 1025px)";var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.responsive,a=r.__rest(e,["responsive"]),i=t&&t.isResponsive?"div":s.VerticallyFixed;return n.createElement(i,a)},t})(n.Component);a.displayName="VerticallyFixedWrapper",t.VerticallyFixedWrapper=a}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/react","modules/clean/react/maestro/responsive","modules/clean/react/prompt/legacy_ha_wrapper"],function(e,t,r,n,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement(s.VerticallyFixedWrapper,{responsive:this.props.responsive,className:"maestro-secondary-sidebar"},this.props.children,n.createElement(a.LegacyHAWrapper,null))},t})(n.Component);t.MaestroSecondarySidebar=i}),define("modules/clean/react/maestro/top_menu_container",["require","exports","tslib","external/react","modules/clean/react/browse/models","modules/core/browser","modules/clean/search/search_bar/controller","modules/clean/search/search_helpers","modules/core/uri","modules/clean/react/css"],function(e,t,r,n,s,a,i,o,_,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e,r){var n=new _({path:"/search/"+t.props.user.role});e&&a.redirect(n.updateQuery({path:t.props.currentPath,query:e,qsid:r}).toString())},t.onSearchResultOpen=function(e){if(e instanceof s.File)if(o.logSearchAction({result:e,user:t.props.user,action_type:e.is_dir?"folder_open":"file_view",viewport:"top-menu-dropdown-view"}),e.is_dir)a.open_tab(e.href);else{var r=e.fq_path.substring(1),n=new _({path:"/"+t.props.user.role}).updateQuery({preview:r});a.open_tab(n.toString())}else e instanceof s.Paper&&(o.logSearchAction({result:e,user:t.props.user,action_type:"paper_open",viewport:"top-menu-dropdown-view"}),a.open_tab(e.url))},t}return r.__extends(t,e),t.prototype.renderSearchBar=function(){return this.props.showSearchBar?n.createElement(i.SearchBarController,{user:this.props.user,currentPath:this.props.currentPath,isExpanded:this.props.isSearchBarExpanded,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onSearchResultOpen:this.props.onSearchResultOpen||this.onSearchResultOpen}):null},t.prototype.renderRightContent=function(){return this.props.rightContent?this.props.rightContent:n.createElement("div",{className:"top-menu-container--search-bar-empty-space"})},t.prototype.render=function(){return n.createElement("div",{className:"top-menu-container "+this.props.classNames},this.renderSearchBar(),this.renderRightContent())},t})(n.Component);l.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1,classNames:"",currentPath:"/"},t.TopMenuContainer=c(l,["/static/css/pagelet-vflBp79rc.css"],[i.SearchBarController])}),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","external/react","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.emitUpdateEvent=function(){s.Emitter.emit(s.Events.REACT_HA_DID_UPDATE)},t.prototype.componentDidMount=function(){t.emitUpdateEvent()},t.prototype.componentDidUpdate=function(){t.emitUpdateEvent()},t.prototype.render=function(){return n.createElement("div",null)},t})(n.Component);a.displayName="LegacyHAWrapper",t.LegacyHAWrapper=a}),define("modules/clean/search/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:100},t.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",t.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",t.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",
t.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",t.SET_SLIM_SEARCH_SUGGESTIONS_ACTION="search__SET_SLIM_SEARCH_SUGGESTIONS",t.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",t.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",t.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",t.CLEAR_SEARCH_BAR_ACTION="search__CLEAR_SEARCH_BAR",t.START_SEARCH_ACTION="search__START_SEARCH",t.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",t.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",t.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",t.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",t.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",t.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",t.SearchLoadingStates={LOADED:"LOADED",LOADING_FIRST_PAGE:"LOADING_FIRST_PAGE",LOADING_ADDITIONAL_PAGE:"LOADING_ADDITIONAL_PAGE"}}),define("modules/clean/search/models",["require","exports","external/deep-freeze","modules/clean/react/browse/models"],function(e,t,r,n){"use strict";function s(e){return new n.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,permanentDeletionDisabledStateByNSID:e.permanent_delete_is_disabled_by_ns_id,blockHash:e.block_hash})}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e){this.fq_path=e.fq_path,this.is_unmounted=e.is_unmounted,this.icon=e.icon,this.filename_highlights=e.filename_highlights,this.ns_id=e.ns_id,this.sjid=e.sjid,this.is_dir=e.is_dir,this.request_id=e.request_id,this.sort_rank=e.sort_rank,r(this)}return e.fromServerObject=function(t){return new e(t)},e})();t.SlimFileSearchResult=a,t.extractBrowseContext=s}),define("modules/clean/search/search_bar/actions",["require","exports","modules/clean/search/constants","modules/clean/search/search_bar/dispatcher","modules/clean/search/search_bar/store"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e){void 0===e&&(e=s.searchBarStore),this._searchBarStore=e}return e.prototype.focusSearchBar=function(){n.SearchBarDispatcher.dispatch({type:r.FOCUS_SEARCH_BAR_ACTION})},e.prototype.blurSearchBar=function(){n.SearchBarDispatcher.dispatch({type:r.BLUR_SEARCH_BAR_ACTION})},e.prototype.setSearchQuery=function(e){var t=e.query,s=e.qsid;n.SearchBarDispatcher.dispatch({type:r.SET_SEARCH_QUERY_ACTION,data:{query:t,qsid:s}})},e.prototype.setSearchSuggestions=function(e){var t=e.searchResults;n.SearchBarDispatcher.dispatch({type:r.SET_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:t}})},e.prototype.setSlimSearchSuggestions=function(e){var t=e.searchResults;n.SearchBarDispatcher.dispatch({type:r.SET_SLIM_SEARCH_SUGGESTIONS_ACTION,data:{searchResults:t}})},e.prototype.setHighlightedRow=function(e){var t=e.index;n.SearchBarDispatcher.dispatch({type:r.SET_HIGHLIGHTED_ROW_ACTION,data:{index:t}})},e.prototype.highlightPreviousRow=function(){n.SearchBarDispatcher.dispatch({type:r.HIGHLIGHT_PREVIOUS_ROW_ACTION})},e.prototype.highlightNextRow=function(){n.SearchBarDispatcher.dispatch({type:r.HIGHLIGHT_NEXT_ROW_ACTION})},e.prototype.clearSearch=function(){n.SearchBarDispatcher.dispatch({type:r.CLEAR_SEARCH_BAR_ACTION})},e})();t.SearchBarActions=a,t.searchBarActions=new a}),define("modules/clean/search/search_bar/api",["require","exports","tslib","modules/clean/ajax","modules/clean/filepath","modules/clean/analytics","modules/clean/react/browse/models","modules/constants/search","modules/clean/search/types","modules/clean/search/models"],function(e,t,r,n,s,a,i,o,_,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(){this._searchApiUrl=o.SEARCH_FRONTEND_SERVICE?"/search/dropdown_search":"/search/lightweight_dropdown_search_meta",this._activeRequest=null}return e.prototype.getSearchApiUrl=function(){return this._searchApiUrl},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype._extractSlimSearchResultsList=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var s=n[r];switch(s.search_result_type){case _.SearchResultTypes.FILE:t.push(c.SlimFileSearchResult.fromServerObject(s));break;case _.SearchResultTypes.PAPER:t.push(i.Paper.fromServerObject(s))}}return t},e.prototype.loadSlimResults=function(e){var t=e.user,r=e.path,n=e.query,s=e.searchSessionID,a=e.webTimer,i=e.onSuccess,o=e.onError,_={query:n,fq_path:r};this._fetchSlimResults(_,t,s,i,o,a)},e.prototype.fetchAdditionalFileMetadata=function(e){var t=this,r=e.searchResults,s=e.user,a=e.onSuccess,i=e.onError,o=r.filter(function(e){return e instanceof c.SlimFileSearchResult}),_=o.map(function(e){return[e.ns_id,e.sjid]});_.length>0?n.WebRequest({url:"/search/search_metadata",data:{nsid_sjid_pairs:JSON.stringify(_)},dataType:"json",subject_user:s,success:function(e,n,s){a(t._mergeFullResultsIntoSlimResults(e.search_results,r))},error:function(e,t,r){"abort"!==t&&"function"==typeof i&&i(r)}}):a(r)},e.prototype._mergeFullResultsIntoSlimResults=function(e,t){for(var n=[],a=function(t){if(t instanceof c.SlimFileSearchResult){var a=e.find(function(e){return e.search_result_type===_.SearchResultTypes.FILE&&s.paths_are_equal(e.fq_path,t.fq_path)});a&&n.push(i.File.fromServerObject(r.__assign({},a,{request_id:t.request_id,sort_rank:t.sort_rank})))}else t instanceof i.Paper&&n.push(t)},o=0,l=t;o<l.length;o++){a(l[o])}return n},e.prototype._fetchSlimResults=function(e,t,r,s,i,o){var _,l=this;null!=this._activeRequest&&this._activeRequest.abort();var u={path_scoped:"/"!==e.fq_path,search_type:"dropdown",query_string:e.query,search_session_id:r};a.SearchClientActivityLogger.log("query_started",t.id,u);var h=(new Date).getTime();this._activeRequest=n.WebRequest({url:this._searchApiUrl,data:e,dataType:"json",subject_user:t,success:function(n,i,_){for(var d=c.extractBrowseContext(n),E=n.search_results,p=_.getResponseHeader("x-dropbox-request-id"),S=0,m=0,A=E;m<A.length;m++){var f=A[m];f.request_id=p,f.sort_rank=S++}var T=l._extractSlimSearchResultsList(E);s({context:d,searchResults:T,deleted:!1});var R=a.SearchClientActivityLogger.create_completion_log_dict(u,!1,p,h,e.query,T.length,null,r);a.SearchClientActivityLogger.log("query_completed",t.id,R),o&&o.end(p?p:void 0)},error:function(n,s,c){"abort"!==s&&"function"==typeof i&&i(c),_=n.getResponseHeader("x-dropbox-request-id");var l=a.SearchClientActivityLogger.create_completion_log_dict(u,null,_,h,e.query,null,s,r);a.SearchClientActivityLogger.log("query_failed",t.id,l),o&&o.abort()},complete:function(){this._activeRequest=null}})},e})();t.SearchBarApiClient=l,t.searchBarApiClient=new l}),define("modules/clean/search/search_bar/api_actions",["require","exports","modules/clean/search/search_bar/store","modules/clean/search/search_bar/actions","modules/clean/search/search_bar/api"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t,a){void 0===e&&(e=s.searchBarApiClient),void 0===t&&(t=r.searchBarStore),void 0===a&&(a=n.searchBarActions),this._searchBarApiClient=e,this._searchBarStore=t,this._searchBarActions=a}return e.prototype.setSearchQuery=function(e){var t=this,r=e.user,n=e.path,s=e.query,a=e.webTimer,i=e.qsid;s!==this._searchBarStore.rawQuery()&&(this._searchBarActions.setSearchQuery({query:s,qsid:i}),this._searchBarStore.isSearchBarLoading()&&this._searchBarApiClient.loadSlimResults({user:r,path:n,query:this._searchBarStore.normalizedQuery(),searchSessionID:this._searchBarStore.searchSessionID(),webTimer:a,onSuccess:function(e){var n=e.searchResults;s===t._searchBarStore.rawQuery()&&(t._searchBarActions.setSlimSearchSuggestions({searchResults:n}),t._searchBarApiClient.fetchAdditionalFileMetadata({searchResults:n,user:r,onSuccess:function(e){s===t._searchBarStore.rawQuery()&&t._searchBarActions.setSearchSuggestions({searchResults:e})}}))}}))},e})();t.SearchBarApiActions=a,t.searchBarApiActions=new a}),define("modules/clean/search/search_bar/controller",["require","exports","tslib","external/react","modules/clean/react/browse/models","modules/clean/keycode","modules/clean/search/search_bar/api_actions","modules/clean/search/search_bar/actions","modules/clean/search/search_bar/api","modules/clean/search/search_helpers","modules/clean/search/search_bar/store","modules/core/notify","modules/clean/search/search_bar/view","modules/clean/react/css","modules/clean/web_timing_logger"],function(e,t,r,n,s,a,i,o,_,c,l,u,h,d,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(t){var r=e.call(this,t)||this;return r._searchBarWebTimer=null,r._onSearchStoreChanged=function(){r.setState(r._getStateFromStore())},r._handleInputChange=function(e){r._setSearchQuery(e.currentTarget.value)},r._handleCancelSearch=function(){r._setSearchQuery("")},r._handleInputKeydown=function(e){if(e.keyCode===a.KeyCode.ESC)return r._handleCancelSearch(),void r.props.onCancelSearch();e.stopPropagation(),e.keyCode===a.KeyCode.UP?(e.preventDefault(),o.searchBarActions.highlightPreviousRow()):e.keyCode===a.KeyCode.DOWN&&(e.preventDefault(),o.searchBarActions.highlightNextRow())},r._handleInputSubmit=function(e,t){if(e.preventDefault(),0===t)r.props.onSearch(r.state.normalizedQuery,r.state.searchSessionID);else{var n=l.searchBarStore.searchSuggestions()[t-1];n?r.props.onSearchResultOpen(n):r._handleSearchResultOpen(l.searchBarStore.slimSearchSuggestions()[t-1])}},r._handleContextMenuCapture=function(e){var t=r.props.user;c.fetchFullSearchResult({searchBarApiClient:_.searchBarApiClient,searchResult:e,user:t,onSuccess:function(e){c.logSearchAction({result:e,user:t,action_type:e instanceof s.File?"context_menu":"paper_context_menu"})}})},r._handleSearchResultOpen=function(e){c.fetchFullSearchResult({searchBarApiClient:_.searchBarApiClient,searchResult:e,user:r.props.user,onSuccess:function(e){r.props.onSearchResultOpen(e)},onError:function(e){u.error(e)}})},r._handleHighlightDropdownItem=function(e){o.searchBarActions.setHighlightedRow({index:e})},r._logSearchBarTTI=function(){r._searchBarWebTimer&&r._searchBarWebTimer.markTimeToInteractive()},r._setSearchBarRef=function(e){return r._searchBarView=e},r.state=r._getStateFromStore(),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){l.searchBarStore.add_change_listener(this._onSearchStoreChanged)},t.prototype.componentWillUnmount=function(){l.searchBarStore.remove_change_listener(this._onSearchStoreChanged)},t.prototype._getStateFromStore=function(){return{isFocused:l.searchBarStore.isSearchBarFocused(),isActive:l.searchBarStore.isSearchBarActive(),rawQuery:l.searchBarStore.rawQuery(),normalizedQuery:l.searchBarStore.normalizedQuery(),suggestions:l.searchBarStore.slimSearchSuggestions(),searchBarLoading:l.searchBarStore.isSearchBarLoading(),searchSessionID:l.searchBarStore.searchSessionID(),highlightedRow:l.searchBarStore.highlightedSearchRow()}},t.prototype.getSearchBarView=function(){return this._searchBarView},t.prototype._setSearchQuery=function(e){var t=this.props,r=t.currentPath,n=t.user;i.searchBarApiActions.setSearchQuery({user:n,query:e,path:r,webTimer:this._startSearchBarTimer()})},t.prototype._startSearchBarTimer=function(){return this._searchBarWebTimer?this._searchBarWebTimer.restart():(this._searchBarWebTimer=E.get_timer("search_bar"),this._searchBarWebTimer.initialize({requireTTI:!0,requireTTV:!1,url:_.searchBarApiClient.getSearchApiUrl()})),this._searchBarWebTimer},t.prototype.render=function(){return n.createElement(h.SearchBarView,r.__assign({},this.props,this.state,{onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchResultOpen:this._handleSearchResultOpen,onContextMenuCapture:this._handleContextMenuCapture,onSearchBarFocus:o.searchBarActions.focusSearchBar,onSearchBarBlur:o.searchBarActions.blurSearchBar,onHighlightDropdownItem:this._handleHighlightDropdownItem,onDropdownTTI:this._logSearchBarTTI,ref:this._setSearchBarRef}))},t})(n.Component);p.defaultProps={onCancelSearch:function(){}},t.SearchBarControllerElement=p,t.SearchBarController=d(p,["/static/css/search/search_bar_react-vfltLEc5w.css"])}),define("modules/clean/search/search_bar/dispatcher",["require","exports","modules/clean/flux/dispatcher"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchBarDispatcher=r}),define("modules/clean/search/search_bar/store",["require","exports","tslib","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/search/constants","modules/clean/search/store_helpers","modules/clean/react/browse/models","modules/clean/react/browse/constants"],function(e,t,r,n,s,a,i,o,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(t){var r=e.call(this,t)||this;return r._resetSearchBar(),r}return r.__extends(t,e),t.prototype._resetSearchBar=function(){this._isSearchBarFocused=!1,this._isSearchBarLoading=!1,this._rawQuery="",this._normalizedQuery="",this._searchSessionID="",this._searchSuggestions=[],this._slimSearchSuggestions=[],this._highlightedSearchRow=0},t.prototype.isSearchBarFocused=function(){return this._isSearchBarFocused},t.prototype.isSearchBarActive=function(){return!!this._rawQuery},t.prototype.isSearchBarLoading=function(){return this._isSearchBarLoading},t.prototype.rawQuery=function(){return this._rawQuery},t.prototype.normalizedQuery=function(){return i.normalize(this._rawQuery)},t.prototype.searchSuggestions=function(){return this._searchSuggestions},t.prototype.slimSearchSuggestions=function(){return this._slimSearchSuggestions},t.prototype.highlightedSearchRow=function(){return this._highlightedSearchRow},t.prototype.searchSessionID=function(){return this._searchSessionID},t.prototype.findSearchFileSuggestion=function(e){var t=e.fq_path;return this._searchSuggestions.find(function(e){return e instanceof o.File&&n.paths_are_equal(e.fq_path,t)})},t.prototype._focusSearchBar=function(){this._isSearchBarFocused=!0,this._highlightedSearchRow=0,this.emit_change()},t.prototype._blurSearchBar=function(){this._isSearchBarFocused=!1,this._highlightedSearchRow=0,this.emit_change()},t.prototype._setRawQuery=function(e,t){t?this._searchSessionID=t:i.shouldStartNewSearchSession(this._rawQuery,e)&&(this._searchSessionID=i.generateRandomID()),this._rawQuery=e},t.prototype._setSearchQuery=function(e){var t=e.query,r=e.qsid;this._setRawQuery(t,r),this._searchSuggestions=[],this._slimSearchSuggestions=[],this._highlightedSearchRow=0,this._isSearchBarLoading=!!this.normalizedQuery(),this.emit_change()},t.prototype._setSearchSuggestions=function(e){var t=e.searchResults;this._isSearchBarLoading=!1,this._searchSuggestions=t,this.emit_change()},t.prototype._setSlimSearchSuggestions=function(e){var t=e.searchResults;this._isSearchBarLoading=!1,this._slimSearchSuggestions=t,this.emit_change()},t.prototype._setHighlightedSearchRow=function(e){var t=e.index;this._highlightedSearchRow=t,this.emit_change()},t.prototype._highlightPreviousSearchRow=function(){this._highlightedSearchRow=Math.max(0,this._highlightedSearchRow-1),this.emit_change()},t.prototype._highlightNextSearchRow=function(){var e=this._slimSearchSuggestions.length||this._searchSuggestions.length;this._highlightedSearchRow=Math.min(e,this._highlightedSearchRow+1),this.emit_change()},t.prototype._clearSearch=function(){this._resetSearchBar(),this.emit_change()},t.prototype._new_payload=function(e){switch(e.action.type){case a.FOCUS_SEARCH_BAR_ACTION:this._focusSearchBar();break;case a.BLUR_SEARCH_BAR_ACTION:this._blurSearchBar();break;case a.SET_SEARCH_QUERY_ACTION:this._setSearchQuery(e.action.data);break;case a.SET_SEARCH_SUGGESTIONS_ACTION:this._setSearchSuggestions(e.action.data);break;case a.SET_SLIM_SEARCH_SUGGESTIONS_ACTION:this._setSlimSearchSuggestions(e.action.data);break;case a.SET_HIGHLIGHTED_ROW_ACTION:this._setHighlightedSearchRow(e.action.data);break;case a.HIGHLIGHT_PREVIOUS_ROW_ACTION:this._highlightPreviousSearchRow();break;case a.HIGHLIGHT_NEXT_ROW_ACTION:this._highlightNextSearchRow();break;case a.CLEAR_SEARCH_BAR_ACTION:this._clearSearch();break;case _.BrowseActionTypes.SET_URL_PREFIX:this._clearSearch()}},t})(s);t.SearchBarStore=c,t.searchBarStore=new c}),define("modules/clean/search/search_bar/view",["require","exports","tslib","external/classnames","external/spectrum/icon_global","modules/clean/react/browse/render_partials","modules/clean/react/browse/paper_row_icon","external/react","jquery","modules/constants/search","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/keycode","modules/clean/react/maestro/a11y_constants","modules/clean/react_format","modules/clean/search/search_helpers","modules/clean/search/models","modules/core/accessible_announce","modules/core/i18n","modules/clean/react/browse/constants"],function(e,t,r,n,s,a,i,o,_,c,l,u,h,d,E,p,S,m,A,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleNavigation=function(){t._searchBarInput.blurSearchBarTextInput()},t._onSearchResultOpen=function(e){t.props.onSearchResultOpen(e),t._handleNavigation()},t._onSearch=function(e,r){var n=t.props.onSearch;n&&n(e,r),t._handleNavigation()},t._setSearchBarInputRef=function(e){return t._searchBarInput=e},t._setSearchBarDropdownRef=function(e){return t._searchBarDropdown=e},t}return r.__extends(t,e),t.prototype.getSearchBarInput=function(){return this._searchBarInput},t.prototype.getSearchBarDropdown=function(){return this._searchBarDropdown},t.prototype.render=function(){var e={"search-bar":!0,"is-expanded":this.props.isExpanded,"is-focused":this.props.isFocused,"is-active":this.props.isActive};return o.createElement("div",{className:"search-bar--container u-l-fr"},o.createElement("div",{className:n(e)},o.createElement(R,r.__assign({},this.props,{ref:this._setSearchBarInputRef})),this.props.normalizedQuery&&this.props.normalizedQuery.length&&o.createElement(O,r.__assign({},this.props,{onSearchResultOpen:this._onSearchResultOpen,onSearch:this._onSearch,isOpen:this.props.isFocused,ref:this._setSearchBarDropdownRef}))))},t})(o.Component);T.defaultProps={rawQuery:"",normalizedQuery:"",showLinkToResultsPage:!0},t.SearchBarView=T;var R=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeydown=function(e){e.keyCode===h.KeyCode.ESC&&(t.blurSearchBarTextInput(),_(t._searchBarTextInput).val("")),t.props.onInputKeydown(e)},t._onSubmit=function(e){var r=t.props.highlightedRow;return t.blurSearchBarTextInput(),t.props.onInputSubmit(e,r)},t._setSearchBarTextInputRef=function(e){return t._searchBarTextInput=e},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){_(this._searchBarTextInput).on("keydown.SearchBarInput",this._onKeydown),_(this._searchBarTextInput).on("focusout.SearchBarInput",this.props.onSearchBarBlur)},t.prototype.componentWillUnmount=function(){_(this._searchBarTextInput).off(".SearchBarInput")},t.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},t.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur(),this.props.onSearchBarBlur()},t.prototype.render=function(){var e=this.props,t=e.onInputChange,r=e.onSearchBarFocus,n=e.onSearchBarBlur,a=e.placeholder,i=e.isFocused,_=e.isActive,c=e.highlightedRow,l=e.rawQuery;return o.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},o.createElement("input",{"aria-activedescendant":"search-dropdown-suggestion"+c,"aria-autocomplete":"list","aria-expanded":i&&_,"aria-label":A._("Search"),"aria-owns":"search-bar__suggestions",className:"search-bar__text-input",onChange:t,onFocus:r,onBlur:n,placeholder:a?a:A._("Search"),ref:this._setSearchBarTextInputRef,role:"combobox",defaultValue:l,tabIndex:d.LAYOUT_TAB_ORDER.SEARCH_BAR}),o.createElement("button",{"aria-label":A._("Search"),className:"search-bar__button",type:"submit"},o.createElement(s.IconGlobal,{name:"search-small"})))},t})(o.Component),O=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._announceLoading=function(){m.AccessibleAnnounce.polite(A._("Loading search"))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.searchBarLoading&&this._announceLoading()},t.prototype.componentDidUpdate=function(e){var t=this.props,r=t.searchBarLoading,n=t.normalizedQuery,s=t.suggestions,a=t.onDropdownTTI;r&&!e.searchBarLoading&&this._announceLoading(),n&&e.searchBarLoading&&!r&&(m.AccessibleAnnounce.polite(A.ungettext("Found %(num)s search result","Found %(num)s search results",s.length).format({num:s.length})),a&&a())},t.prototype.render=function(){for(var e=[],t=0;t<this.props.suggestions.length;t++){var s=this.props.suggestions[t];s instanceof S.SlimFileSearchResult||s instanceof u.File?e.push(o.createElement(D,r.__assign({},this.props,{resultObject:s,key:s.fq_path,rank:t}))):s instanceof u.Paper&&e.push(o.createElement(g,r.__assign({},this.props,{resultObject:s,key:s.pad_id,rank:t})))}var a={"search-bar__dropdown":!0,"is-expanded":this.props.isOpen};return o.createElement("div",{className:n(a),"aria-hidden":!this.props.isOpen},o.createElement("div",{className:"search-bar__suggestions",id:"search-bar__suggestions"},this.props.showLinkToResultsPage&&o.createElement(I,r.__assign({},this.props)),e),this.props.searchBarLoading&&o.createElement("div",{className:"search-bar__loading"},o.createElement("span",{className:"ax-visually-hidden"},A._("Loading search..."))))},t})(o.Component);O.defaultProps={showLinkToResultsPage:!0};var I=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTitle=function(){return"IGNORE"===c.SEARCH_PATH_SCOPE||l.paths_are_equal(t.props.currentPath,"/")?E.reactFormat(A._("View all results for <strong>%(query)s</strong>"),{query:t.props.normalizedQuery,strong:o.createElement("strong",{key:"title"})}):E.reactFormat(A._("Search for <strong>%(query)s</strong> in %(current_path)s"),{current_path:l.filename(t.props.currentPath),query:t.props.normalizedQuery,strong:o.createElement("strong",{key:"title"})})},t._onMouseDown=function(e){e.stopPropagation(),e.preventDefault(),p.shouldHandleClick(e)&&t.props.onSearch(t.props.normalizedQuery)},t._onMouseEnter=function(){return t.props.onHighlightDropdownItem(0)},t}return r.__extends(t,e),t.prototype.render=function(){var e=0===this.props.highlightedRow,t={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":e,"search-bar__full_search_suggestion":!0},r=this.props.currentPath;"IGNORE"===c.SEARCH_PATH_SCOPE&&(r="/");var s=p.buildSearchURL({user:this.props.user,currentPath:r,normalizedQuery:this.props.normalizedQuery,searchSessionID:this.props.searchSessionID,searchToken:c.SEARCH_TOKEN_CONSTANT}).toString();return o.createElement("a",{href:s,className:n(t),id:"search-dropdown-suggestion0",onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter,role:"option","aria-selected":e},o.createElement("div",{className:"search-bar__suggestion-icon--search"}),o.createElement("div",{className:"search-bar__suggestion-first-row-name"},this._renderTitle()))},t})(o.Component),g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject;return o.createElement(N,r.__assign({},this.props,{icon:o.createElement(i.PaperRowIcon,{className:"search-bar__suggestion-icon"}),title:p.highlightMatchReact(e.title,e.title_highlights),location:"Paper"}))},t})(o.Component),D=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.resultObject,t=l.filename(e.fq_path),n=l.parent_dir(e.fq_path),s="Dropbox",i=n.split("/");i.shift(),e.is_unmounted&&i.length>0&&(s=i.shift());var _=i[i.length-1];i.length>=2&&(s+="/..."),_&&_.length&&(s+="/"+_);var c=e.is_dir?f.FileTypes.FOLDER:f.FileTypes.FILE,u=r.__assign({type:c,isDeleted:e.is_unmounted},e);return o.createElement(N,r.__assign({},this.props,{icon:o.createElement(a.FileIcon,{className:"search-bar__suggestion-icon",file:u}),title:p.highlightMatchReact(t,e.filename_highlights),location:s,isUnmounted:e.is_unmounted}))},t})(o.Component),N=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onMouseDown=function(e){e.stopPropagation(),e.preventDefault(),p.shouldHandleClick(e)&&t.props.onSearchResultOpen(t.props.resultObject)},t._onMouseEnter=function(){return t.props.onHighlightDropdownItem(t._listIndex)},t._onContextMenuCapture=function(){var e=t.props,r=e.onContextMenuCapture,n=e.resultObject;r&&r(n)},t}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,r=t.highlightedRow,s=t.isUnmounted,a=t.location,i=t.resultObject,_=t.user,c=t.rank,l=t.icon,u=t.title;this._listIndex=c+1;var h=this._listIndex===r,d={"search-bar__suggestion":!0,"search-bar__suggestion--is-highlighted":h};e=s?E.reactFormat(A._("not added yet, in <locationSpan>%(location)s</locationSpan>",{comment:"Describes the mountable directory of a file in a list of search results."}),{location:a,locationSpan:o.createElement("span",{key:"location",title:a})}):E.reactFormat(A._("<locationSpan>in %(location)s</locationSpan>",{comment:"Describes the parent directory of a file in a list of search results."}),{location:a,locationSpan:o.createElement("span",{key:"location",title:a})});var S=p.resultObjectToUrl(i,_);return o.createElement("li",{className:n(d),id:"search-dropdown-suggestion"+this._listIndex,role:"option","aria-selected":h,onMouseDown:this._onMouseDown,onMouseEnter:this._onMouseEnter},l,o.createElement("a",{href:S,onContextMenuCapture:this._onContextMenuCapture},o.createElement("div",{className:"search-bar__suggestion-name"},u),o.createElement("div",{className:"search-bar__suggestion-desc"},e)))},t})(o.Component)}),define("modules/clean/search/search_helpers",["require","exports","tslib","jquery","external/classnames","react","modules/clean/search/search_bar/store","modules/clean/react/browse/models","modules/clean/search/models","modules/core/i18n","modules/core/uri","modules/clean/browse_interface","modules/core/browser","modules/clean/analytics"],function(e,t,r,n,s,a,i,o,_,c,l,u,h,d){"use strict";function E(e){var t=e.user,r=e.currentPath,n=e.normalizedQuery,s=e.searchSessionID,a=e.searchToken;return new l({path:"/search/"+t.role,query:{path:r,query:n,qsid:s,token:a}})}function p(e,t){return e instanceof _.SlimFileSearchResult?u.browse_uri_for_fq_path(t,e.fq_path).toString():e.url}function S(e,t){if(!t||!t.length)return[];var r=[],n=0;return t.forEach(function(t){var s=t.pos;s>n&&(n=s);var a=e.indexOf(t.string,n);a>=0&&r.push({pos:a,len:t.string.length,string:t.string})}),r}function m(e,t){if(!t)return[{text:e,isHighlighted:!1}];t=S(e,t);for(var r=0,n=0,s=[];r<e.length;){var a=void 0,i=void 0,o=t[n];n>=t.length?(i=!1,a=r+e.length):o.pos>r?(i=!1,a=o.pos):(i=!0,a=o.pos+o.len);var _=e.substring(r,a);s.push({text:_,isHighlighted:i}),r=a,i&&n++}return s}function A(e,t){return m(e,t).reduce(function(e,t){var r=n("<span/>").text(t.text);return t.isHighlighted&&(r.addClass("highlighted"),r.addClass("is-highlighted")),e.append(r)},n("<span />"))}function f(e,t){var r=m(e,t);return a.createElement("span",null,r.map(function(e,t){return a.createElement("span",{className:s({highlighted:e.isHighlighted,"is-highlighted":e.isHighlighted}),key:t},e.text)}))}function T(e){var t=e.searchBarApiClient,r=e.searchResult,n=e.user,s=e.onSuccess,a=e.onError;if(r instanceof _.SlimFileSearchResult){var l=i.searchBarStore.findSearchFileSuggestion(r);l?s(l):t.fetchAdditionalFileMetadata({searchResults:[r],user:n,onSuccess:function(e){if(e.length>0)s(e[0]);else if(a){var t=c._("There was a problem completing this request.");a(t)}},onError:a})}else r instanceof o.Paper&&s(r)}function R(){return h.mac}function O(e){return 0===e.button&&!e.altKey&&(!t.isMac()&&!e.ctrlKey||t.isMac()&&!e.metaKey)}function I(e){var t=e.result,n=e.user,s=e.action_type,a=e.viewport,o=void 0===a?"full-view":a,_=e.view_type,c={viewport:o,action_type:s,search_session_id:i.searchBarStore.searchSessionID(),view_type:_,position:t.sort_rank,request_id:t.request_id};if(g(t)){var l=t;c=r.__assign({},c,{file_nsid:l.ns_id,file_sjid:l.sjid,match_type:l.match_type})}else if(D(t)){var u=t;c=r.__assign({},c,{paper_pad_id:u.pad_id,position:u.sort_rank,request_id:u.request_id})}d.SearchClientActivityLogger.log("result_action",n.id,c)}function g(e){return void 0!==e.ns_id}function D(e){return void 0!==e.pad_id}Object.defineProperty(t,"__esModule",{value:!0}),t.buildSearchURL=E,t.resultObjectToUrl=p,t.highlightMatchSections=m,t.highlightMatchJQuery=A,t.highlightMatchReact=f,t.fetchFullSearchResult=T,t.isMac=R,t.shouldHandleClick=O,t.logSearchAction=I}),define("modules/clean/search/store_helpers",["require","exports"],function(e,t){"use strict";function r(e){return e.trim().replace(/\ +/g," ")}function n(e){return!r(e)}function s(e,t){return!(!n(e)||n(t))||e.length>=3&&1===t.length}function a(){for(var e="",t=0;t<32;t++){var r=Math.floor(10*Math.random());e+=String(r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=r,t.isBlank=n,t.shouldStartNewSearchSession=s,t.generateRandomID=a}),define("modules/clean/search/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResultTypes={FILE:"FILE",PAPER:"PAPER"}}),define("modules/clean/sharing/constants",["require","exports","external/underscore","modules/constants/sharing"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER_NO_COMMENT=-10]="ACCESS_READER_NO_COMMENT",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(t.NameSpaceAccess||(t.NameSpaceAccess={}));(function(e){e[e.PUBLIC=1]="PUBLIC",e[e.TEAM_ONLY=2]="TEAM_ONLY",e[e.PASSWORD=3]="PASSWORD",e[e.ONLY_YOU=99]="ONLY_YOU"})(t.SHMODEL_LINK_TOKEN_VISIBILITY||(t.SHMODEL_LINK_TOKEN_VISIBILITY={})),t.ACCESS_LEVEL={OWNER:"owner",WRITER:"writer",READER:"reader",READER_NO_COMMENT:"reader_no_comment"},t.MEMBER_ACTION={LEAVE_A_COPY:"leave_a_copy",MAKE_EDITOR:"make_editor",MAKE_OWNER:"make_owner",MAKE_VIEWER:"make_viewer",MAKE_VIEWER_NO_COMMENT:"make_viewer_no_comment",REMOVE:"remove",ALL:["leave_a_copy","make_editor","make_owner","make_viewer","make_viewer_no_comment","remove"]},t.SNIPPET_SIZES={FILENAME:22,DISPLAY_NAME:26,EMAIL:30,OUT_OF_QUOTA_FOLDER_NAME:15},t.VALIDATE_PATH_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",relinquish_membership:"canRelinquishMembership"},t.VALIDATE_PATH_PERMISSIONS_CONFIDENTIAL_AWARE={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality",relinquish_membership:"canRelinquishMembership"},t.ALPHA_FOLDER_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",edit_contents:"canEditContents",enable_viewer_info:"enableViewerInfo",invite_editor:"canInviteEditor",invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",leave_a_copy:"leaveACopy",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unmount:"canUnmountFolder",unshare:"canUnshareFolder",update_confidentiality:"canUpdateConfidentiality"},t.ALPHA_FILE_METADATA_PERMISSIONS={change_options:"canChangeOptions",disable_viewer_info:"disableViewerInfo",enable_viewer_info:"enableViewerInfo",
invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",remove_download_policy:"removeDownloadPolicy",set_download_policy:"setDownloadPolicy",unshare:"unshare"},t.FILE_METADATA_PERMISSIONS={invite_viewer:"canInviteViewer",invite_viewer_no_comment:"canInviteViewerNoComment",relinquish_membership:"canRelinquishMembership",unshare:"unshare"},t.SHARE_ACTION_ORIGIN_TYPE={BROWSE_FILE_ACTIONS:"BROWSE_FILE_ACTIONS",BROWSE_FILE_ROW:"BROWSE_FILE_ROW",BROWSE_GLOBAL_ACTIONS:"BROWSE_GLOBAL_ACTIONS",BROWSE_SHARED_FOLDER_BANNER:"BROWSE_SHARED_FOLDER_BANNER",CONTENT_MANAGER:"CONTENT_MANAGER",DESKTOP_CLIENT:"DESKTOP_CLIENT",EVENTS_PAGE:"EVENTS_PAGE",FILE_ROW_SHARE_MENU:"FILE_ROW_SHARE_MENU",GRANT_ACCESS:"GRANT_ACCESS",LEGACY_BROWSE:"LEGACY_BROWSE",LINKS_PAGE:"LINKS_PAGE",NOTIFICATION_WEB:"NOTIFICATION_WEB",OFFICE_INTEGRATION:"OFFICE_INTEGRATION",OUT_OF_QUOTA_MODAL:"OUT_OF_QUOTA_MODAL",PARENT_FOLDER_MODAL:"PARENT_FOLDER_MODAL",PREVIEW_PAGE:"PREVIEW_PAGE",PREVIEW_PAGE_FACEPILE:"PREVIEW_PAGE_FACEPILE",RECENTS:"RECENTS",SHARE:"SHARE",SHARE_LINK_MODAL:"SHARE_LINK_MODAL",SYNC_MODAL:"SYNC_MODAL",WIZARD:"WIZARD"},t.TOKEN_LINK_TYPE={SHARED_LINK:"s",SHARED_CONTENT_LINK:"c"},t.ACCESS_VALUES=r.values(t.ACCESS_LEVEL),t.FILE_REQUESTS=n.FILE_REQUESTS,t.GOLDEN_GATE=n.GOLDEN_GATE,t.NDSL=n.NDSL,t.PASS_CONTROL_AVAILABILITY=n.PASS_CONTROL_AVAILABILITY,t.REQUEST_ACCESS=n.REQUEST_ACCESS,t.ShareTibActionOriginType=n.ShareTibActionOriginType,t.SHARING_EXPERIMENTS=n.SHARING_EXPERIMENTS,t.SHARING_UNSHARING=n.SHARING_UNSHARING,t.TRUELINK=n.TRUELINK}),function(){define("modules/clean/web_user_action_logger",["modules/clean/ajax"],function(e){var t,r,n,s;return s={DOWNLOAD:"download",MOVE:"move",OPEN_MOVE_MODAL:"open_move_modal",RENAME:"rename",ADD_COMMENT:"add_comment",OPEN_COPY_MODAL:"open_copy_modal",COPY:"copy",DELETE:"delete",PERMANENT_DELETE:"permanent_delete",VERSIONS:"versions",SORT_RECORDS:"sort_records",SELECT_ROW:"select_row",OPEN_ROW:"open_row",UPLOAD_FILE:"upload_file",CREATE_FOLDER:"create_folder",VIEW_SHARE_MODEL:"view_share_model",TOGGLE_DELETED_FILES:"toggle_deleted_files",NAV_NEW_PAGE:"nav_new_page",SWITCH_ACCOUNT:"switch_account",SWITCH_TO_GRID_VIEW:"switch_to_grid_view",SWITCH_TO_LIST_VIEW:"switch_to_list_view"},r=3,t=6e5,n=(function(){function n(){}return n.prototype.error_count=0,n.prototype.last_error=Date.now(),n.prototype.should_report=!0,n.prototype.log=function(n,s,a){if(this.should_report&&(this.error_count<r||Date.now()-this.last_error>t))return e.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:n,event_type:s,extra_params:JSON.stringify(a)},error:(function(e){return function(t){return 429===t.status?e.error_count=r:e.error_count+=1,e.last_error=Date.now()}})(this),success:(function(e){return function(t){var r,n;try{return r=JSON.parse(t),(null!=r?r.continue_sending:void 0)||(e.should_report=!1),e.error_count=0}catch(t){throw n=t,e.error_count+=1,e.last_error=Date.now(),n}}})(this)})},n})(),{WebUserActionLog:new n,WebUserActionLogEvents:s,WebUserActionLogClass:n,MAX_ERRORS:r}})}.call(this);
//# sourceMappingURL=pkg-embedded_app.min.js-vfllZahrZ.map